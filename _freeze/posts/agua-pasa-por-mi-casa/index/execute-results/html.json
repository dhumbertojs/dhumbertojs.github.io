{
  "hash": "a659b66bf3156f3100ec374e810dafe7",
  "result": {
    "markdown": "---\ntitle: \"¿Agua pasa por mi casa?\"\ndescription: \"Análisis de Solicitudes de Información Pública (SIP) relacionadas al tema de agua potable en la Ciudad de México\"\nauthor: \"David Humberto Jiménez S.\"\ndate: \"2024-02-03\"\ncategories: [code, text-analysis, visualization, spanish]\n#image: \"dias-sin-ti.jpg\"\n---\n\n\n> “Un mago nunca llega tarde, Frodo Bolsón. Ni pronto. Llega exactamente cuando se lo propone.” Gandalf\n\n¡Bienvenidxs! Sé que he tenido abandonado este proyecto durante algún tiempo. Pero, la verdad sea dicha, he tenido mucho trabajo.\n\nEste es el primer post de la nueva iteración del blog (la tercera) y ahora está montado sobre [Quarto](https://quarto.org/docs/guide/). ¿Que qué es _quarto_? Quarto es un sistema de código abierto (Open source) para la publicación técnica/científica. Esto quiere decir que un montón de personas brillantes estaban hartas de lidiar con varias herramientas al mismo tiempo para trabajar y poder publicar sus artículos, páginas, libros y blogs. La principal ventaja, para mí, es que puedes trabajar con python, R, Julia y Observable JS; dentro del mismo documento. Aunque nunca he utilizado Julia. \n\nAdemás, los documentos utilizan la misma estructura que un markdown lo que nos facilita la vida, ya que no hay que aprender sintaxis nueva. En fin, tal vez es la emoción hablando, así que vayan, revísenlo y si les convence úsenlo. Toda la información [aquí](https://quarto.org/).\n\n# El reporte\n\nDurante 2023 hice muchas cosas, principalmente trabajar, pero en uno de esos bellos momentos donde los astros se alinean y puedes trabajar en algo interesante con libertad, participé junto con otras compañeras del equipo en el reporte especial [“¿Agua pasa por mi casa?](https://infocdmx.org.mx/images/biblioteca/2023/Reporte_Especial_de_Apertura_1_%202023_Agua_%20pasa_por_mi_casa_La_transparencia_de_la_gestion_del_agua_en_la_CDMX.pdf) La transparencia de la gestión del agua en la CDMX.\n\nSe trata de un informe sobre \n> “las actividades relacionadas con el abastecimiento, cobro, cesión de derechos, saneamiento, desarrollo de infraestructura, mantenimiento de las fuentes de agua, así como todo lo relacionado para tener un empleo adecuado del recurso”.\n\nEn este hice un análisis de la distribución de las Solicitudes de Información Pública a lo largo del tiempo, como en el caso del metro que pueden consultar [aquí](https://dhumbertojs.github.io/posts/linea-12/).\n\nPara este reporte se revisaron las Solicitudes de Información Pública (SIP) recibidas por todos los sujetos obligados del 2006 al 2022, esto equivale a un total de 1,610,228 solicitudes. Se seleccionaron 40,269 solicitudes y se decidió utilizar un conjunto de palabras clave que deben aparecer al menos una vez dentro del cuerpo de la solicitud. Usando “expresiones regulares” (regex) se detectaron palabras completas, o que empiecen y terminen con una determinada combinación de letras, además de que no importa si están escritas en mayúsculas o minúsculas. \n\n## Selección de SIP\n\nSe emplearon las siguientes palabras: “agua” (exacta); que empezará con “Hidri” o “hidrí” (por ejemplo, hídrico); “sequía” o “sequía”; “inundaciones”, “pozos” o “posos”; la combinación de las palabras “captador” y “lluvia” o “pluvial”; así como la combinación de “saneamiento”, “fuga”, “corte” y todas las anteriores. Al tratarse de una selección automatizada, existe la posibilidad de encontrar resoluciones o solicitudes que no pertenezcan a la temática planteada y contengan una o varias de las palabras listadas. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(httr)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'httr' was built under R version 4.2.3\n```\n:::\n\n```{.r .cell-code}\nlibrary(purrr)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'purrr' was built under R version 4.2.3\n```\n:::\n\n```{.r .cell-code}\nlibrary(dplyr)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'dplyr'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n```\n:::\n\n```{.r .cell-code}\nlibrary(tidyr)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'tidyr' was built under R version 4.2.3\n```\n:::\n\n```{.r .cell-code}\nlibrary(readxl)\nlibrary(stringr)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'stringr' was built under R version 4.2.3\n```\n:::\n\n```{.r .cell-code}\nlibrary(janitor)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'janitor' was built under R version 4.2.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'janitor'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:stats':\n\n    chisq.test, fisher.test\n```\n:::\n\n```{.r .cell-code}\nlibrary(writexl)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'writexl' was built under R version 4.2.3\n```\n:::\n\n```{.r .cell-code}\nlibrary(tidytext)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'tidytext' was built under R version 4.2.3\n```\n:::\n\n```{.r .cell-code}\nlibrary(lubridate)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'lubridate'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:base':\n\n    date, intersect, setdiff, union\n```\n:::\n\n```{.r .cell-code}\n# Datos -------------------------------------------------------------------\n\nurl <- c(\n    \"https://datosabiertos.infocdmx.org.mx/dataset/6dda3a6f-4e2a-484c-9613-89899058f70d/resource/9c683caf-f559-462c-8e70-845c8902d7b4/download/_limpia_2022.xlsx\",\n    \"https://datosabiertos.infocdmx.org.mx/dataset/2e770767-dfe5-4ba2-9af3-61338cc6509b/resource/43f4549c-9cba-4737-b86b-f2ee4924ddf8/download/limpia_2021.xlsx\",\n    \"https://datosabiertos.infocdmx.org.mx/dataset/f8a7fab6-8466-4e1c-b3fb-b0d29afd2f83/resource/2a29d720-32bc-4268-90da-3b374aaa4379/download/limpia_2020.xlsx\",\n    \"https://datosabiertos.infocdmx.org.mx/dataset/f92cb601-9b13-4e58-9556-9810c5347e2b/resource/d7019dab-918c-41e9-ad6d-9fb9838c5021/download/limpia_2019.xlsx\",\n    \"https://datosabiertos.infocdmx.org.mx/dataset/29faea7e-4d34-4f5d-bdd4-50b61ace1f32/resource/074b6c4e-89fd-4119-a43a-69b1e007e1b3/download/limpia_2018.xlsx\",\n    \"https://datosabiertos.infocdmx.org.mx/dataset/e42ccdad-f383-485b-802f-9aba520df083/resource/e8b2d6d6-c4cf-4a49-ac2b-512ab3597283/download/limpia_2017.xlsx\",\n    \"https://datosabiertos.infocdmx.org.mx/dataset/017c49f8-39f7-4942-9408-728046586bc8/resource/5c68a7a5-be2d-4a4f-ad04-ff04a9ed2889/download/limpia_2016.xlsx\",\n    \"https://datosabiertos.infocdmx.org.mx/dataset/bdadb1ab-e476-4c47-95fb-4a2d4af9e2de/resource/540d06f9-b9a2-4f56-b23d-1e84e2ed85a2/download/limpia_2015.xlsx\",\n    \"https://datosabiertos.infocdmx.org.mx/dataset/e905654e-6a6a-4d0d-912f-17b5270aabf2/resource/d68925b2-fcd3-4676-b2c5-d73c3ac69d9a/download/limpia_2014.xlsx\",\n    \"https://datosabiertos.infocdmx.org.mx/dataset/69b31de6-3a7b-4892-ac2e-79c7043616b4/resource/52c81f47-214b-4888-9869-0b17b781ebb9/download/limpia_2013.xlsx\",\n    \"https://datosabiertos.infocdmx.org.mx/dataset/850fb128-2643-40b5-bbb4-f7a378494f90/resource/2bef2739-b570-4c80-afb2-e8ccb59e8f2c/download/limpia_2012.xlsx\",\n    \"https://datosabiertos.infocdmx.org.mx/dataset/f4842322-3068-475f-b8c0-9a65b0a011e6/resource/de055dd6-2eb2-4d75-adb9-2041b47fdb4e/download/limpia_2011.xlsx\",\n    \"https://datosabiertos.infocdmx.org.mx/dataset/7bdd86c0-93b9-4dd6-be66-a39ec814be1c/resource/5043bd4d-07bf-40db-a9df-8f2755aa36bc/download/limpia_2010.xlsx\",\n    \"https://datosabiertos.infocdmx.org.mx/dataset/4ef8d70d-21c9-427b-95c2-8c006f4fec16/resource/132a3785-c718-4122-96df-031437d2f289/download/limpia_2009.xlsx\",\n    \"https://datosabiertos.infocdmx.org.mx/dataset/1422cec6-f8e9-4715-bc49-ea66afff640a/resource/a27a3b30-b727-4650-896d-1258729e13ba/download/limpia_2008.xlsx\",\n    \"https://datosabiertos.infocdmx.org.mx/dataset/bad94346-71e9-438d-b026-689d228e2d33/resource/2eb8f23e-a098-4746-80ce-e52562bd1f11/download/limpia_2007.xlsx\",\n    \"https://datosabiertos.infocdmx.org.mx/dataset/17b24af2-4950-4476-91a1-d934fd4d7c68/resource/e0d70ebb-7c16-46c7-8865-c537df8ff637/download/limpia_2006.xlsx\"\n)\n\ntemp_files <- map(url, ~ {\n    temp_file <- tempfile()\n    GET(.x, write_disk(temp_file))\n    temp_file\n})\n\nlista <- map(temp_files, ~ {\n    read_excel(.x) %>%\n        clean_names() %>%\n        mutate_all(as.character)\n})\n\nlista <- bind_rows(lista)\nmap(temp_files, unlink)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[[1]]\n[1] 0\n\n[[2]]\n[1] 0\n\n[[3]]\n[1] 0\n\n[[4]]\n[1] 0\n\n[[5]]\n[1] 0\n\n[[6]]\n[1] 0\n\n[[7]]\n[1] 0\n\n[[8]]\n[1] 0\n\n[[9]]\n[1] 0\n\n[[10]]\n[1] 0\n\n[[11]]\n[1] 0\n\n[[12]]\n[1] 0\n\n[[13]]\n[1] 0\n\n[[14]]\n[1] 0\n\n[[15]]\n[1] 0\n\n[[16]]\n[1] 0\n\n[[17]]\n[1] 0\n```\n:::\n\n```{.r .cell-code}\n# Filtro ------------------------------------------------------------------\n\nfiltro <- lista %>%\n    mutate(\n        awa = ifelse(str_detect(\n            descripcion_solicitud,\n            regex(\"\\\\bagua\\\\b\", ignore_case = T)\n        ), 1, 0),\n        fug = ifelse(str_detect(\n            descripcion_solicitud,\n            regex(\"fuga\", ignore_case = T)\n        ), 1, 0),\n        corte = ifelse(str_detect(\n            descripcion_solicitud,\n            regex(\"\\\\bcorte|\\\\bcorta\", ignore_case = T)\n        ), 1, 0),\n        esc = ifelse(str_detect(\n            descripcion_solicitud,\n            regex(\"\\\\besca\", ignore_case = T)\n        ), 1, 0),\n        h = ifelse(str_detect(\n            descripcion_solicitud,\n            regex(\"hidrí|hidri\", ignore_case = T)\n        ), 1, 0),\n        f1 = ifelse(str_detect(\n            descripcion_solicitud,\n            regex(\"sequía|sequia\", ignore_case = T)\n        ), 1, 0),\n        f2 = ifelse(str_detect(\n            descripcion_solicitud,\n            regex(\"inundaciones\", ignore_case = T)\n        ), 1, 0),\n        f3 = ifelse(str_detect(\n            descripcion_solicitud,\n            regex(\"saneamiento\", ignore_case = T)\n        ), 1, 0),\n        f4 = ifelse(str_detect(\n            descripcion_solicitud,\n            regex(\"pozos|posos\", ignore_case = T)\n        ), 1, 0),\n        f5 = ifelse(str_detect(\n            descripcion_solicitud,\n            regex(\"captador\", ignore_case = T)\n        ), 1, 0),\n        f6 = ifelse(str_detect(\n            descripcion_solicitud,\n            regex(\"humedal\", ignore_case = T)\n        ), 1, 0),\n        f7 = ifelse(str_detect(\n            descripcion_solicitud,\n            regex(\"pluvial|lluvia\", ignore_case = T)\n        ), 1, 0)\n    ) %>%\n    mutate(f7 = ifelse(f5 == 1 & f7 == 1, 1, 0)) %>%\n    rowwise() %>%\n    mutate(\n        f3 = ifelse(f3 == 1, sum(awa, fug, corte, esc, h, f1, f2, f3, f4, f5, f6, f7), 0)\n    )\n\nver <- filtro %>%\n    filter(awa == 1 | h == 1 | f1 == 1 | f2 == 1 | f3 > 1 | f4 == 1 | f7 == 1) %>%\n    mutate(\n        organo_de_gobierno = case_when(\n            str_detect(dependencia, \"Alcal\") ~ \"Alcaldías\",\n            str_detect(dependencia, \"Dele\") ~ \"Alcaldías\",\n            str_detect(dependencia, \"Agua\") ~ \"Organismos desconcentrados, descentralizados, paraestatales y auxiliares\",\n            str_detect(dependencia, \"Ambiental y\") ~ \"Organismos desconcentrados, descentralizados, paraestatales y auxiliares\",\n            str_detect(dependencia, \"Medio A\") ~ \"Administración Pública Central\",\n            str_detect(dependencia, \"Obras\") ~ \"Administración Pública Central\",\n            str_detect(dependencia, \"Protección Civil\") ~ \"Administración Pública Central\",\n            str_detect(dependencia, \"Planeación\") ~ \"Organismos desconcentrados, descentralizados, paraestatales y auxiliares\",\n            str_detect(dependencia, \"Jefatura\") ~ \"Administración Pública Central\",\n            str_detect(dependencia, \"Secretaría de Desarrollo Urbano y Vivienda\") ~ \"Administración Pública Central\",\n            T ~ organo_de_gobierno\n        ),\n        organo_de_gobierno = str_replace_all(\n            organo_de_gobierno, \"Administración Pública Centralizada\",\n            \"Administración Pública Central\"\n        ),\n        organo_de_gobierno = str_remove_all(organo_de_gobierno, \"\\\\(baja 10-06-2019\\\\)\"),\n        organo_de_gobierno = str_trim(organo_de_gobierno, \"both\"),\n        organo_de_gobierno = str_replace_all(\n            organo_de_gobierno, \"Instituto para la Atención de los Adultos Mayores en el Distrito Federal \\\\(17/02/2010\\\\)\",\n            \"Organismos desconcentrados, descentralizados, paraestatales y auxiliares\"\n        ),\n        organo_de_gobierno = str_replace_all(\n            organo_de_gobierno, \"Desconcentrados, Descentralizados, Paraestatales y Auxiliares\",\n            \"Organismos desconcentrados, descentralizados, paraestatales y auxiliares\"\n        ),\n        organo_de_gobierno = str_replace_all(\n            organo_de_gobierno, \"Descentralizados\",\n            \"Organismos desconcentrados, descentralizados, paraestatales y auxiliares\"\n        ),\n        organo_de_gobierno = str_replace_all(\n            organo_de_gobierno, \"Fondos y fideicomisos públicos\",\n            \"Fideicomisos y fondos públicos\"\n        ),\n        organo_de_gobierno = str_replace_all(\n            organo_de_gobierno, \"Organismos Autónomos\",\n            \"Órganos Autónomos\"\n        ),\n        organo_de_gobierno = str_replace_all(\n            organo_de_gobierno, \"Órgano Autónomo\",\n            \"Órganos Autónomos\"\n        ),\n        organo_de_gobierno = str_replace_all(\n            organo_de_gobierno, \"Órgano Autónomo\",\n            \"Órganos Autónomos\"\n        ),\n        organo_de_gobierno = str_replace_all(\n            organo_de_gobierno, \"Tribunales Administrativos\",\n            \"Órganos Autónomos\"\n        ),\n        organo_de_gobierno = str_replace_all(\n            organo_de_gobierno, \"Órgano político administrativos\",\n            \"Organismos desconcentrados, descentralizados, paraestatales y auxiliares\"\n        ),\n        organo_de_gobierno = str_replace_all(\n            organo_de_gobierno, \"\\\\bÓrgano\\\\b\",\n            \"Poder\"\n        ),\n        organo_de_gobierno = str_remove_all(organo_de_gobierno, \"en el Distrito Federal\"),\n        organo_de_gobierno = str_trim(organo_de_gobierno, \"both\"),\n        organo_de_gobierno = str_replace_all(\n            organo_de_gobierno, \"Entidades Paramunicipales\",\n            \"Organismos desconcentrados, descentralizados, paraestatales y auxiliares\"\n        )\n    ) %>%\n    filter(organo_de_gobierno != \"Sindicatos\") %>%\n    select(-c(18:29))\n\nver <- ver %>%\n    unite(fecha_de_ingreso, fecha_de_ingreso, fecha_ingreso) %>%\n    unite(otros_datos, otros_datos, otro_datos) %>%\n    mutate(\n        otros_datos = str_remove_all(otros_datos, \"_NA\"),\n        otros_datos = str_remove_all(otros_datos, \"NA_\")\n    ) %>%\n    mutate(\n        fecha_de_ingreso = str_remove_all(fecha_de_ingreso, \"_NA\"),\n        fecha_de_ingreso = str_remove_all(fecha_de_ingreso, \"NA_\"),\n        fecha_de_ingreso = as_datetime(fecha_de_ingreso)\n    ) %>%\n    mutate(\n        dependencia = str_remove_all(dependencia, \"Alcaldía \"),\n        dependencia = str_remove_all(dependencia, \"Delegación \"),\n        dependencia = str_remove_all(dependencia, \"[.]$\"),\n        dependencia = str_remove_all(dependencia, \"de la Ciudad de México\"),\n        dependencia = str_remove_all(dependencia, \"del Distrito Federal\"),\n        dependencia = str_trim(dependencia, \"both\"),\n        dependencia = str_replace_all(dependencia, \"Gustavo A Madero\", \"Gustavo A. Madero\")\n    ) %>%\n    mutate(\n        dependencia = str_trim(dependencia, \"both\")\n    ) %>%\n    arrange(desc(fecha_de_ingreso)) %>%\n    group_by(as.character(folio)) %>%\n    slice(1) %>%\n    ungroup() %>%\n    select(-16)\n\nlevels(as.factor(ver$dependencia))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  [1] \"Agencia de Atención Animal\"                                                                                        \n  [2] \"Agencia de Gestión Urbana\"                                                                                         \n  [3] \"Agencia de Protección Sanitaria\"                                                                                   \n  [4] \"Agencia de Protección Sanitaria del Gobierno\"                                                                      \n  [5] \"Agencia Digital de Innovación Pública\"                                                                             \n  [6] \"Álvaro Obregón\"                                                                                                    \n  [7] \"Asamblea Legislativa\"                                                                                              \n  [8] \"Auditoría Superior\"                                                                                                \n  [9] \"Autoridad de Espacios Públicos\"                                                                                    \n [10] \"Autoridad de la Zona Patrimonio Mundial Natural y Cultural de la Humanidad en Xochimilco, Tláhuac y Milpa Alta\"    \n [11] \"Autoridad del Centro Histórico\"                                                                                    \n [12] \"Autoridad del Espacio Público\"                                                                                     \n [13] \"Azcapotzalco\"                                                                                                      \n [14] \"Benito Juárez\"                                                                                                     \n [15] \"Caja de Previsión de la Policía Auxiliar\"                                                                          \n [16] \"Caja de Previsión de la Policía Preventiva\"                                                                        \n [17] \"Caja de Previsión para Trabajadores a Lista de Raya\"                                                               \n [18] \"Calidad de Vida, Progreso y Desarrollo para la Ciudad de México, S.A. de C.V\"                                      \n [19] \"Calidad de Vida, Progreso y Desarrollo para la Ciudad de México, SA de CV\"                                         \n [20] \"Centro de Atención a Emergencias y Protección Ciudadana\"                                                           \n [21] \"Centro de Comando, Control, Cómputo, Comunicaciones y Contacto Ciudadano\"                                          \n [22] \"Comisión de Búsqueda de Personas\"                                                                                  \n [23] \"Comisión de Derechos Humanos\"                                                                                      \n [24] \"Comisión de Filmaciones\"                                                                                           \n [25] \"Comisión Ejecutiva de Atención a Víctimas\"                                                                         \n [26] \"Comisión para la Reconstrucción\"                                                                                   \n [27] \"Comisión para la Reconstrucción, Recuperación y Transformación , en una CDMX cada vez más resiliente\"              \n [28] \"Congreso\"                                                                                                          \n [29] \"Consejería Jurídica y de Servicios Legales\"                                                                        \n [30] \"Consejo de Evaluación\"                                                                                             \n [31] \"Consejo de Evaluación del Desarrollo Social\"                                                                       \n [32] \"Consejo de la Judicatura\"                                                                                          \n [33] \"Consejo Económico y Social\"                                                                                        \n [34] \"Consejo para Prevenir y Eliminar la Discriminación en la Ciudad de México\"                                         \n [35] \"Contaduría Mayor de Hacienda de la Asamblea Legislativa del D.F\"                                                   \n [36] \"Contaduría Mayor de Hacienda de la Asamblea Legislativa del DF\"                                                    \n [37] \"Contraloría General\"                                                                                               \n [38] \"Coordinación de los Centros de Transferencia Modal\"                                                                \n [39] \"Corporación Mexicana de Impresión S.A. de C.V\"                                                                     \n [40] \"Corporación Mexicana de Impresión SA de CV\"                                                                        \n [41] \"Corporación Mexicana de Impresión, S.A. de C.V\"                                                                    \n [42] \"Coyoacán\"                                                                                                          \n [43] \"Cuajimalpa de Morelos\"                                                                                             \n [44] \"Cuauhtémoc\"                                                                                                        \n [45] \"Encuentro Social\"                                                                                                  \n [46] \"Escuela de Administración Pública\"                                                                                 \n [47] \"Fideicomiso Bienestar Educativo\"                                                                                   \n [48] \"Fideicomiso Central de Abasto\"                                                                                     \n [49] \"Fideicomiso Centro Histórico\"                                                                                      \n [50] \"Fideicomiso de Recuperación Crediticia\"                                                                            \n [51] \"Fideicomiso de Recuperación Crediticia  (FIDERE III)\"                                                              \n [52] \"Fideicomiso Educación Garantizada\"                                                                                 \n [53] \"Fideicomiso Fondo de Promoción para el Financiamiento del Transporte Público\"                                      \n [54] \"Fideicomiso Fondo para el Desarrollo Económico y Social\"                                                           \n [55] \"Fideicomiso Museo de Arte Popular Mexicano\"                                                                        \n [56] \"Fideicomiso Museo del Estanquillo\"                                                                                 \n [57] \"Fideicomiso para el Fondo de Promoción para el Financiamiento del Transporte Público\"                              \n [58] \"Fideicomiso para el Mejoramiento de las Vías de Comunicación\"                                                      \n [59] \"Fideicomiso para la Promoción y Desarrollo del Cine Mexicano en el Distrito Federal\"                               \n [60] \"Fideicomiso para la Promoción y Desarrollo del Cine Mexicano en la Ciudad de México\"                               \n [61] \"Fideicomiso para la Reconstrucción\"                                                                                \n [62] \"Fideicomiso Público \\\"Ciudad Digital\\\"\"                                                                            \n [63] \"Fideicomiso Público Complejo Ambiental Xochimilco\"                                                                 \n [64] \"Fideicomiso Público de la Zona de Santa Fe\"                                                                        \n [65] \"Fideicomiso Público del Fondo de Apoyo a la Procuración de Justicia\"                                               \n [66] \"Fiscalía General de Justicia de la CDMX\"                                                                           \n [67] \"Fiscalía Generar de Justicia de la CDMX\"                                                                           \n [68] \"Fondo Ambiental Público\"                                                                                           \n [69] \"Fondo de Desarrollo Económico\"                                                                                     \n [70] \"Fondo de Desarrollo Económico  (FONDECO)\"                                                                          \n [71] \"Fondo de Seguridad Pública\"                                                                                        \n [72] \"Fondo Mixto de Promoción Turística\"                                                                                \n [73] \"Fondo para el Desarrollo Social\"                                                                                   \n [74] \"Fondo para la Atención y Apoyo a las Víctimas del Delito\"                                                          \n [75] \"Fondo Público de Atención al Ciclista y al Peatón\"                                                                 \n [76] \"Fuerza Social por México\"                                                                                          \n [77] \"Gustavo A. Madero\"                                                                                                 \n [78] \"Heroico Cuerpo de Bomberos\"                                                                                        \n [79] \"Instancia Ejecutora del Sistema Integral de Derechos Humanos\"                                                      \n [80] \"Instituto de Acceso a la Información Pública y Protección de Datos Personales\"                                     \n [81] \"Instituto de Capacitación para el Trabajo\"                                                                         \n [82] \"Instituto de Educación Media Superior\"                                                                             \n [83] \"Instituto de Formación Profesional\"                                                                                \n [84] \"Instituto de Formación Profesional (PGJDF)\"                                                                        \n [85] \"Instituto de la Juventud\"                                                                                          \n [86] \"Instituto de las Mujeres\"                                                                                          \n [87] \"Instituto de Planeación Democrática y Prospectiva\"                                                                 \n [88] \"Instituto de Transparencia, Acceso a la Información Pública, Protección de Datos Personales y Rendición de Cuentas\"\n [89] \"Instituto de Verificación Administrativa\"                                                                          \n [90] \"Instituto de Vivienda\"                                                                                             \n [91] \"Instituto del Deporte\"                                                                                             \n [92] \"Instituto Electoral\"                                                                                               \n [93] \"Instituto Local de la Infraestructura Física Educativa\"                                                            \n [94] \"Instituto para la Atención de los Adultos Mayores en el Distrito Federal\"                                          \n [95] \"Instituto para la Atención y Prevención de las Adicciones en la Ciudad de México\"                                  \n [96] \"Instituto para la Integración al Desarrollo de las Personas con Discapacidad\"                                      \n [97] \"Instituto para la Seguridad de las Construcciones en el Distrito Federal\"                                          \n [98] \"Instituto para la Seguridad de las Construcciones en la Ciudad de México\"                                          \n [99] \"Instituto Técnico de Formación Policial\"                                                                           \n[100] \"Iztacalco\"                                                                                                         \n[101] \"Iztapalapa\"                                                                                                        \n[102] \"Jefatura de Gobierno\"                                                                                              \n[103] \"Junta de Asistencia Privada\"                                                                                       \n[104] \"Junta Local de Conciliación y Arbitraje\"                                                                           \n[105] \"La Magdalena Contreras\"                                                                                            \n[106] \"Metrobús\"                                                                                                          \n[107] \"Miguel Hidalgo\"                                                                                                    \n[108] \"Milpa Alta\"                                                                                                        \n[109] \"MORENA\"                                                                                                            \n[110] \"Movimiento Ciudadano\"                                                                                              \n[111] \"Oficialía Mayor\"                                                                                                   \n[112] \"Oficialía Mayor del Gobierno\"                                                                                      \n[113] \"Órgano Regulador de Transporte\"                                                                                    \n[114] \"P - MORENA\"                                                                                                        \n[115] \"P - Movimiento Ciudadano\"                                                                                          \n[116] \"P - Nueva Alianza\"                                                                                                 \n[117] \"P - Partido Acción Nacional\"                                                                                       \n[118] \"P - Partido de la Revolución Democrática\"                                                                          \n[119] \"P - Partido del Trabajo\"                                                                                           \n[120] \"P - Partido Revolucionario Institucional\"                                                                          \n[121] \"P - Partido Socialdemócrata\"                                                                                       \n[122] \"P - Partido Verde Ecologista de México\"                                                                            \n[123] \"Partido Acción Nacional\"                                                                                           \n[124] \"Partido de la Revolución Democrática\"                                                                              \n[125] \"Partido del Trabajo\"                                                                                               \n[126] \"Partido Encuentro Solidario\"                                                                                       \n[127] \"Partido Equidad, Libertad y Género\"                                                                                \n[128] \"Partido Revolucionario Institucional\"                                                                              \n[129] \"Partido Verde Ecologista de México\"                                                                                \n[130] \"Planta de Asfalto\"                                                                                                 \n[131] \"Policia Auxiliar\"                                                                                                  \n[132] \"Policía Auxiliar\"                                                                                                  \n[133] \"Policía Bancaria e Industrial\"                                                                                     \n[134] \"PROCDMX, S.A. DE C.V\"                                                                                              \n[135] \"Procuraduría Ambiental y del Ordenamiento Territorial\"                                                             \n[136] \"Procuraduría General de Justicia\"                                                                                  \n[137] \"Procuraduría Social\"                                                                                               \n[138] \"Proyecto Metro\"                                                                                                    \n[139] \"Red de Transporte de Pasajeros\"                                                                                    \n[140] \"Red de Transporte Público de Pasajeros\"                                                                            \n[141] \"Red de Transporte Público de Pasajeros  (RTP)\"                                                                     \n[142] \"Régimen de Protección Social en Salud\"                                                                             \n[143] \"Secretaría de Administración y Finanzas\"                                                                           \n[144] \"Secretaría de Ciencia, Tecnología e Innovación\"                                                                    \n[145] \"Secretaría de Cultura\"                                                                                             \n[146] \"Secretaría de Desarrollo Económico\"                                                                                \n[147] \"Secretaría de Desarrollo Rural y Equidad para las Comunidades\"                                                     \n[148] \"Secretaría de Desarrollo Social\"                                                                                   \n[149] \"Secretaría de Desarrollo Urbano y Vivienda\"                                                                        \n[150] \"Secretaría de Educación\"                                                                                           \n[151] \"Secretaría de Educación, Ciencia, Tecnología e Innovación\"                                                         \n[152] \"Secretaría de Finanzas\"                                                                                            \n[153] \"Secretaría de Gestión Integral de Riesgos y Protección Civil\"                                                      \n[154] \"Secretaría de Gobierno\"                                                                                            \n[155] \"Secretaría de Inclusión y Bienestar Social\"                                                                        \n[156] \"Secretaría de la Contraloría General\"                                                                              \n[157] \"Secretaría de las Mujeres\"                                                                                         \n[158] \"Secretaría de Movilidad\"                                                                                           \n[159] \"Secretaría de Obras y Servicios\"                                                                                   \n[160] \"Secretaría de Protección Civil\"                                                                                    \n[161] \"Secretaría de Pueblos y Barrios Originarios y Comunidades Indígenas Residentes\"                                    \n[162] \"Secretaría de Salud\"                                                                                               \n[163] \"Secretaría de Seguridad Ciudadana\"                                                                                 \n[164] \"Secretaría de Seguridad Pública\"                                                                                   \n[165] \"Secretaría de Trabajo y Fomento al Empleo\"                                                                         \n[166] \"Secretaría de Transportes y Vialidad\"                                                                              \n[167] \"Secretaría de Turismo\"                                                                                             \n[168] \"Secretaría del Medio Ambiente\"                                                                                     \n[169] \"Secretaría Ejecutiva del Mecanismo de Seguimiento y Evaluación del Programa de Derechos Humanos\"                   \n[170] \"Secretaría Ejecutiva del Sistema Anticorrupción\"                                                                   \n[171] \"Servicio de Medios Públicos\"                                                                                       \n[172] \"Servicio de Transportes Eléctricos\"                                                                                \n[173] \"Servicios de Salud Pública\"                                                                                        \n[174] \"Servicios Metropolitanos, S.A. de C.V\"                                                                             \n[175] \"Servicios Metropolitanos, SA de CV\"                                                                                \n[176] \"Sistema de Aguas\"                                                                                                  \n[177] \"Sistema de Movilidad 1 (Sistema M1)\"                                                                               \n[178] \"Sistema de Radio y Televisión Digital del Gobierno  (Capital 21)\"                                                  \n[179] \"Sistema de Transporte Colectivo\"                                                                                   \n[180] \"Sistema para el Desarrollo Integral de la Familia\"                                                                 \n[181] \"Sistema Público de Radiodifusión\"                                                                                  \n[182] \"Tláhuac\"                                                                                                           \n[183] \"Tlalpan\"                                                                                                           \n[184] \"Tribunal de Justicia Administrativa\"                                                                               \n[185] \"Tribunal de lo Contencioso Administrativo\"                                                                         \n[186] \"Tribunal Electoral\"                                                                                                \n[187] \"Tribunal Superior de Justicia\"                                                                                     \n[188] \"Universidad Autónoma\"                                                                                              \n[189] \"Universidad de la Policía\"                                                                                         \n[190] \"Universidad de la Salud\"                                                                                           \n[191] \"Venustiano Carranza\"                                                                                               \n[192] \"Xochimilco\"                                                                                                        \n```\n:::\n\n```{.r .cell-code}\nnrow(ver)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 40269\n```\n:::\n\n```{.r .cell-code}\n# write_xlsx(ver, \"SIP_agua.xlsx\")\n```\n:::\n\n\nLos datos de la APi tienen 14 variables:\n\n1. folio: Identificador único de la solicitud. \n2. fecha_de_ingreso: Fecha y hora en la que se ingresó la solicitud. \n3. dependencia: nombre de la institución pública a la que se realizó la solicitud \n4. organo_de_gobierno: ámbito al que pertenece la dependencia (alcaldías, administración pública central, fondos y fideicomisos, etc.). \n5. descripcion_solicitud: texto de la solicitud realizada por la persona solicitante.\n6. estatus: Estado actual de la solicitud (pendiente, desechada, en proceso, terminada, etc.). \n7. medio_entrada: Medio por el cual se ingresó la solicitud (telefónico, presentada en la Unidad de Transparencia, por medio electrónicos, etc.) \n8. otros_datos: Otros datos relevantes de la solicitud registrados por la persona solicitante, mismos que no son obligatorios. \n9. fecha_limite_de_respuesta: Fecha límite para la respuesta de la solicitud en función de la fecha de ingreso y alguno de los siguientes supuestos: si se determina competencia (3 días), prevención (10 días después de la notificación), si ya se encuentra publicada al ser una obligación de transparencia (5 días) o bien 9 días una vez aceptada la solicitud. \n10. respuesta: variable categórica con una clasificación del tipo de respuesta de la dependencia (entrega de información, prevenida, improcedente, registro de pago, etc.). \n11. texto_de_la_respuesta: Texto de la respuesta a la solicitud no disponible en todas las SIP, ya que en muchos casos se remite al oficio de respuesta enviado a través del sistema INFOMEX o de la PNT. \n12. pais: País de origen de la solicitud (en su mayoría México) y no obligatorio. \n13. estado: Estado de origen de la solicitud (en su mayoría Ciudad de México) y no obligatorio. \n14. fecha_respuesta: Fecha en la que la dependencia dio la respuesta a la solicitud. \n\n## K - means\n\nPara hacer un análisis más detallado, utilicé un algoritmo de clasificación no supervisada k-means con *6 clusters*. De ahí tomé una muestra de 300 solicitudes, 50 por cada grupo. Con un análisis de palabras frecuentes y lectura de las SIP en la muestra, etiqueté y filtré manualmente (en caso de que hubiera solicitudes que no tuvieran relación con el tema, por ejemplo:solicitudes relacionadas con una calle llamada lluvia), hasta contar con un subconjunto de 273 SIP, mismo que se empleó para ejecutar un algoritmo de clasificación supervisada, en donde esta muestra funcionó como base de datos de entrenamiento, para etiquetar las 40,269 solicitudes. \n\n\n::: {.cell}\n\n```{.python .cell-code}\nimport numpy as np\nimport pandas as pd\nfrom sklearn.feature_extraction.text import TfidfVectorizer\nfrom sklearn.cluster import KMeans\nfrom sklearn.metrics import adjusted_rand_score\nfrom sklearn.decomposition import PCA\nfrom sklearn.metrics import silhouette_score\nimport nltk\nfrom nltk.corpus import stopwords\nimport openpyxl\nimport matplotlib.pyplot as plt\n\ndf = pd.read_excel(\"D:/dhumb/Documents/projects/data_blog/agua/SIP_agua.xlsx\")\ndata = df\n\nvectorizer = TfidfVectorizer()\nX = vectorizer.fit_transform(data['descripcion_solicitud'])\n\n# Aplicar k-means\nkmeans = KMeans(n_clusters=6, random_state=0, n_init=10)\nclusters = kmeans.fit_predict(X)\n\n# Agregar los resultados al DataFrame\ndata['cluster'] = clusters\n```\n:::\n\n\n## Ensamble learning\n\nPara este último paso, la clasificación supervisada de textos, es necesario entrenar un modelo de aprendizaje automático con una muestra de datos ya etiquetados, con el objetivo de que el modelo aprenda a clasificar datos nuevos. Se aplicó un preprocesamiento de los textos para convertirlos en vectores numéricos, y se entrenó un modelo de ensamble que combina diferentes clasificadores (SVM, regresión logística y Naive Bayes) utilizando validación cruzada estratificada para encontrar los mejores hiperparámetros a través de GridSearchCV. Una vez que el modelo se entrenó, se usó para predecir las etiquetas de la descripción de las solicitudes. \n\n\n::: {.cell}\n\n```{.python .cell-code}\nimport pandas as pd\nfrom sklearn.feature_extraction.text import TfidfVectorizer\nfrom sklearn.pipeline import Pipeline\nfrom sklearn.model_selection import GridSearchCV, StratifiedKFold\nfrom sklearn.ensemble import VotingClassifier\nfrom sklearn.naive_bayes import MultinomialNB\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.svm import SVC\nfrom sklearn.metrics import classification_report\n\n# Cargar datos de muestra etiquetados\ndf_labeled = pd.read_excel(\n    \"D:/dhumb/Documents/projects/data_blog/agua/Muestra.xlsx\")\n\n# Separar datos de muestra en características y etiquetas\nX_train = df_labeled['descripcion_solicitud']\ny_train = df_labeled['label']\n\n# Vectorizar datos de muestra y conjunto de datos original\nvectorizer = TfidfVectorizer(max_features=4500)\nX_train_vectorized = vectorizer.fit_transform(X_train)\n\n# Definir modelos\nnb_model = MultinomialNB()\nsvm_model = SVC(probability=True)\nlr_model = LogisticRegression()\n\n# Definir ensamble de modelos con GridSearchCV\nestimators = [('nb', nb_model), ('svm', svm_model), ('lr', lr_model)]\nvoting_model = VotingClassifier(estimators=estimators, voting='soft')\n\n# Definir parámetros para GridSearchCV\nparams = {\n    'nb__alpha': [0.5, 1, 2],\n    'svm__C': [0.1, 1, 10],\n    'lr__C': [0.1, 1, 10]\n}\n\n# Definir validación cruzada estratificada con 5 particiones\ncv = StratifiedKFold(n_splits=5)\n\n# Ajustar ensamble de modelos utilizando GridSearchCV y validación cruzada estratificada\ngrid_search = GridSearchCV(voting_model, params, cv=cv)\ngrid_search.fit(X_train_vectorized, y_train)\n```\n\n::: {.cell-output-display}\n```{=html}\n<style>#sk-container-id-1 {color: black;background-color: white;}#sk-container-id-1 pre{padding: 0;}#sk-container-id-1 div.sk-toggleable {background-color: white;}#sk-container-id-1 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-1 label.sk-toggleable__label-arrow:before {content: \"▸\";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-1 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-1 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-1 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: \"▾\";}#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-1 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-1 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-1 div.sk-parallel-item::after {content: \"\";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-serial::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-1 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-1 div.sk-item {position: relative;z-index: 1;}#sk-container-id-1 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-1 div.sk-item::before, #sk-container-id-1 div.sk-parallel-item::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-1 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-1 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-1 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-1 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-1 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-1 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-1 div.sk-label-container {text-align: center;}#sk-container-id-1 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-1 div.sk-text-repr-fallback {display: none;}</style><div id=\"sk-container-id-1\" class=\"sk-top-container\"><div class=\"sk-text-repr-fallback\"><pre>GridSearchCV(cv=StratifiedKFold(n_splits=5, random_state=None, shuffle=False),\n             estimator=VotingClassifier(estimators=[(&#x27;nb&#x27;, MultinomialNB()),\n                                                    (&#x27;svm&#x27;,\n                                                     SVC(probability=True)),\n                                                    (&#x27;lr&#x27;,\n                                                     LogisticRegression())],\n                                        voting=&#x27;soft&#x27;),\n             param_grid={&#x27;lr__C&#x27;: [0.1, 1, 10], &#x27;nb__alpha&#x27;: [0.5, 1, 2],\n                         &#x27;svm__C&#x27;: [0.1, 1, 10]})</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class=\"sk-container\" hidden><div class=\"sk-item sk-dashed-wrapped\"><div class=\"sk-label-container\"><div class=\"sk-label sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-1\" type=\"checkbox\" ><label for=\"sk-estimator-id-1\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">GridSearchCV</label><div class=\"sk-toggleable__content\"><pre>GridSearchCV(cv=StratifiedKFold(n_splits=5, random_state=None, shuffle=False),\n             estimator=VotingClassifier(estimators=[(&#x27;nb&#x27;, MultinomialNB()),\n                                                    (&#x27;svm&#x27;,\n                                                     SVC(probability=True)),\n                                                    (&#x27;lr&#x27;,\n                                                     LogisticRegression())],\n                                        voting=&#x27;soft&#x27;),\n             param_grid={&#x27;lr__C&#x27;: [0.1, 1, 10], &#x27;nb__alpha&#x27;: [0.5, 1, 2],\n                         &#x27;svm__C&#x27;: [0.1, 1, 10]})</pre></div></div></div><div class=\"sk-parallel\"><div class=\"sk-parallel-item\"><div class=\"sk-item\"><div class=\"sk-label-container\"><div class=\"sk-label sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-2\" type=\"checkbox\" ><label for=\"sk-estimator-id-2\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">estimator: VotingClassifier</label><div class=\"sk-toggleable__content\"><pre>VotingClassifier(estimators=[(&#x27;nb&#x27;, MultinomialNB()),\n                             (&#x27;svm&#x27;, SVC(probability=True)),\n                             (&#x27;lr&#x27;, LogisticRegression())],\n                 voting=&#x27;soft&#x27;)</pre></div></div></div><div class=\"sk-serial\"><div class=\"sk-item sk-dashed-wrapped\"><div class=\"sk-parallel\"><div class=\"sk-parallel-item\"><div class=\"sk-item\"><div class=\"sk-label-container\"><div class=\"sk-label sk-toggleable\"><label>nb</label></div></div><div class=\"sk-serial\"><div class=\"sk-item\"><div class=\"sk-estimator sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-3\" type=\"checkbox\" ><label for=\"sk-estimator-id-3\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">MultinomialNB</label><div class=\"sk-toggleable__content\"><pre>MultinomialNB()</pre></div></div></div></div></div></div><div class=\"sk-parallel-item\"><div class=\"sk-item\"><div class=\"sk-label-container\"><div class=\"sk-label sk-toggleable\"><label>svm</label></div></div><div class=\"sk-serial\"><div class=\"sk-item\"><div class=\"sk-estimator sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-4\" type=\"checkbox\" ><label for=\"sk-estimator-id-4\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">SVC</label><div class=\"sk-toggleable__content\"><pre>SVC(probability=True)</pre></div></div></div></div></div></div><div class=\"sk-parallel-item\"><div class=\"sk-item\"><div class=\"sk-label-container\"><div class=\"sk-label sk-toggleable\"><label>lr</label></div></div><div class=\"sk-serial\"><div class=\"sk-item\"><div class=\"sk-estimator sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-5\" type=\"checkbox\" ><label for=\"sk-estimator-id-5\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">LogisticRegression</label><div class=\"sk-toggleable__content\"><pre>LogisticRegression()</pre></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div>\n```\n:::\n\n```{.python .cell-code}\n# Imprimir mejores hiperparámetros encontrados por GridSearchCV\nprint(\"Mejores hiperparámetros encontrados por GridSearchCV:\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nMejores hiperparámetros encontrados por GridSearchCV:\n```\n:::\n\n```{.python .cell-code}\nprint(grid_search.best_params_)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n{'lr__C': 10, 'nb__alpha': 2, 'svm__C': 10}\n```\n:::\n\n```{.python .cell-code}\n# Cargar datos del conjunto de datos original\ndf_unlabeled = pd.read_excel(\n    \"D:/dhumb/Documents/projects/data_blog/agua/SIP_agua.xlsx\")\n# Quitar los datos etiquetados de la muestra\ndf_unlabeled = df_unlabeled[~df_unlabeled['folio'].isin(df_labeled['folio'])]\n\n# Vectorizar datos del conjunto de datos original\nX_unlabeled = df_unlabeled['descripcion_solicitud']\nX_unlabeled_vectorized = vectorizer.transform(X_unlabeled)\n\n# Predecir etiquetas para el conjunto de datos original\ny_pred = grid_search.predict(X_unlabeled_vectorized)\n\n# Agregar etiquetas al conjunto de datos original\ndf_unlabeled['etiqueta'] = y_pred\n\n# Imprimir reporte de clasificación\nprint(classification_report(y_train, grid_search.predict(X_train_vectorized)))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                                                      precision    recall  f1-score   support\n\n                                      Abastecimiento       1.00      1.00      1.00        26\nDiagnósticos, informes, reportes, opiniones técnicas       1.00      1.00      1.00        18\n                                   Impacto ambiental       1.00      1.00      1.00         5\n                             Infraestructura y obras       1.00      1.00      1.00        34\n                      Mantenimiento y rehabilitación       1.00      0.94      0.97        18\n                                    Pago de derechos       0.95      1.00      0.98        60\n                                Permisos y contratos       0.98      1.00      0.99        42\n                                               Pipas       1.00      1.00      1.00        62\n                                         Presupuesto       1.00      0.62      0.77         8\n\n                                            accuracy                           0.99       273\n                                           macro avg       0.99      0.95      0.97       273\n                                        weighted avg       0.99      0.99      0.98       273\n```\n:::\n\n```{.python .cell-code}\n\n# Une los datos\ndata = pd.concat([df_unlabeled, df_labeled])\n\n#data.to_excel('D:/dhumb/Documents/projects/data_blog/agua/ensamble_2.xlsx', index=False)\n```\n:::\n\n\nEn total se definieron nueve categorías que se listan a continuación: \n\n1. Abastecimiento. Se refiere a la distribución de agua en la CDMX, extracción de esta y prestación del servicio. \n2. Diagnósticos, informes, reportes, opiniones técnicas. Sobre los estudios, diagnósticos o informes generados sobre el agua. \n3. Impacto ambiental. Los estudios de impacto ambiental solicitados por las personas. \n4. Infraestructura y obras. Se refiere a las solicitudes del mapa de distribución, ubicación de pozos, proyectos de obras hidráulicas. \n5. Mantenimiento y rehabilitación. En esta categoría se encuentran los trabajos de rehabilitación, reparación de fugas y mantenimiento de la red hidráulica. \n6. Pago de derechos. Se refiere a las tarifas, pago de las mismas o explicación de estas. \n7. Permisos y contratos. Estas solicitudes se refieren a los permisos otorgados a obras, por ejemplo departamentos o plazas comerciales. \n8. Pipas. Se refiere a aquellas solicitudes donde se solicita información sobre las pipas de agua (horarios, costos, etc.). \n9. Presupuesto. En esta categoría se encuentran las solicitudes que preguntan por los presupuestos para el pago de agua (garrafones, botellas, tarifas, etc.). \n\n## Visualizaciones\n\nY después de tirar código es moemnto de... tirar más código :D Pero esta vez para poder sacar conclusiones de los datos que ya se han trabajado. Estas gráficas son propuestas que están en el reporte ya mencionado, así como otras que no quedaron por falta de espacio y detalle para explicarlas.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tm)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'tm' was built under R version 4.2.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: NLP\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'NLP'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:httr':\n\n    content\n```\n:::\n\n```{.r .cell-code}\nlibrary(clipr)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'clipr' was built under R version 4.2.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWelcome to clipr. See ?write_clip for advisories on writing to the clipboard in R.\n```\n:::\n\n```{.r .cell-code}\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(readxl)\nlibrary(scales)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'scales'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:purrr':\n\n    discard\n```\n:::\n\n```{.r .cell-code}\nlibrary(viridis)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: viridisLite\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'viridis'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:scales':\n\n    viridis_pal\n```\n:::\n\n```{.r .cell-code}\nlibrary(stringr)\nlibrary(ggplot2)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'ggplot2'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:NLP':\n\n    annotate\n```\n:::\n\n```{.r .cell-code}\nlibrary(writexl)\nlibrary(ggrepel)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'ggrepel' was built under R version 4.2.3\n```\n:::\n\n```{.r .cell-code}\nlibrary(tidytext)\nlibrary(lubridate)\nlibrary(SnowballC)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'SnowballC' was built under R version 4.2.3\n```\n:::\n\n```{.r .cell-code}\n## Conteo ------------------------------------------------------------------\n\ndata <- read_excel(\"D:/dhumb/Documents/projects/data_blog/agua/ensamble_2.xlsx\") %>%\n    mutate(\n        folio = as.character(folio),\n        folio = paste0(\"0\", folio),\n        anio = year(fecha_de_ingreso),\n        dependencia = str_remove_all(dependencia, \"P - \"),\n        dependencia = str_remove_all(dependencia, \"\\\\(RTP\\\\)\"),\n        dependencia = str_remove_all(dependencia, \"\\\\(FONDECO\\\\)\"),\n        dependencia = str_remove_all(dependencia, \"\\\\(PGJDF\\\\)\"),\n        dependencia = str_remove_all(dependencia, \"\\\\(FIDERE III\\\\)\"),\n        dependencia = str_remove_all(dependencia, \"en el Distrito Federal\"),\n        dependencia = str_remove_all(dependencia, \"en la Ciudad de México\"),\n        dependencia = str_replace_all(dependencia, \"SA de CV\", \"S.A. de C.V\"),\n        dependencia = str_replace_all(dependencia, \"Generar\", \"General\"),\n        dependencia = str_replace_all(dependencia, \"DF\", \"D.F\"),\n        dependencia = str_replace_all(\n            dependencia, \"Corporación Mexicana de Impresión, S.A. de C.V\",\n            \"Corporación Mexicana de Impresión S.A. de C.V\"\n        ),\n        dependencia = str_replace_all(dependencia, \"Policia\", \"Policía\"),\n        dependencia = str_replace_all(dependencia, \"\\\\bEncuentro Social\\\\b\", \"Partido Encuentro Solidario\"),\n        dependencia = str_trim(dependencia, \"both\"),\n        organo_de_gobierno = str_replace_all(\n            organo_de_gobierno,\n            \"Organismos desconcentrados, descentralizados, paraestatales y auxiliares\",\n            \"Organismos desconcentrados,\\ndescentralizados, paraestatales\\ny auxiliares\"\n        ),\n        organo_de_gobierno = str_replace_all(\n            organo_de_gobierno,\n            \"Fideicomisos y fondos públicos\",\n            \"Fideicomisos y\\nfondos públicos\"\n        ),\n        etiqueta = str_replace_all(\n            etiqueta, \"Diagnósticos, informes, reportes, opiniones técnicas\",\n            \"Diagnósticos, informes, \\nreportes, opiniones técnicas\"\n        ),\n        estatus = str_to_sentence(estatus),\n        estatus = ifelse(estatus == \"Proceso\", \"En proceso\", estatus),\n        respuesta = str_remove_all(respuesta, \"\\\\bA[.]\"),\n        respuesta = str_remove_all(respuesta, \"\\\\bB[.]\"),\n        respuesta = str_remove_all(respuesta, \"\\\\bC[.]\"),\n        respuesta = str_remove_all(respuesta, \"\\\\bD[.]\"),\n        respuesta = str_remove_all(respuesta, \"\\\\bE[.]\"),\n        respuesta = str_remove_all(respuesta, \"\\\\bF[.]\"),\n        respuesta = str_remove_all(respuesta, \"\\\\bG[.]\"),\n        respuesta = str_remove_all(respuesta, \"\\\\bH[.]\"),\n        respuesta = str_replace_all(respuesta, \"\\\\bRR\\\\b\", \"Recurso de Revisión\"),\n        respuesta = str_trim(respuesta, \"both\"),\n        respuesta = str_replace_all(respuesta, \"à\", \"á\"),\n        respuesta = str_remove_all(respuesta, \"[.]$\"),\n        respuesta = case_when(\n            str_detect(respuesta, regex(\"entrega|información\", ignore_case = T)) ~ \"Entrega de información solicitada\",\n            T ~ respuesta\n        ),\n        respuesta = str_to_sentence(respuesta)\n    )\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q39998 / R39998C17: got 'Pago de derechos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q39999 / R39999C17: got 'Pago de derechos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40000 / R40000C17: got 'Pago de derechos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40001 / R40001C17: got 'Abastecimiento'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40002 / R40002C17: got 'Pago de derechos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40003 / R40003C17: got 'Pago de derechos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40004 / R40004C17: got 'Pago de derechos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40005 / R40005C17: got 'Pago de derechos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40006 / R40006C17: got 'Pago de derechos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40007 / R40007C17: got 'Pago de derechos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40008 / R40008C17: got 'Pago de derechos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40009 / R40009C17: got 'Pago de derechos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40010 / R40010C17: got 'Presupuesto'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40011 / R40011C17: got 'Pago de derechos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40012 / R40012C17: got 'Pago de derechos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40013 / R40013C17: got 'Pago de derechos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40014 / R40014C17: got 'Pago de derechos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40015 / R40015C17: got 'Pago de derechos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40016 / R40016C17: got 'Pago de derechos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40017 / R40017C17: got 'Pago de derechos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40018 / R40018C17: got 'Pago de derechos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40019 / R40019C17: got 'Pago de derechos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40020 / R40020C17: got 'Presupuesto'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40021 / R40021C17: got 'Pago de derechos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40022 / R40022C17: got 'Mantenimiento y\nrehabilitación'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40023 / R40023C17: got 'Pago de derechos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40024 / R40024C17: got 'Pago de derechos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40025 / R40025C17: got 'Pago de derechos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40026 / R40026C17: got 'Pago de derechos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40027 / R40027C17: got 'Abastecimiento'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40028 / R40028C17: got 'Pago de derechos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40029 / R40029C17: got 'Pago de derechos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40030 / R40030C17: got 'Pago de derechos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40031 / R40031C17: got 'Presupuesto'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40032 / R40032C17: got 'Pago de derechos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40033 / R40033C17: got 'Pago de derechos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40034 / R40034C17: got 'Pago de derechos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40035 / R40035C17: got 'Pago de derechos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40036 / R40036C17: got 'Pago de derechos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40037 / R40037C17: got 'Pago de derechos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40038 / R40038C17: got 'Pago de derechos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40039 / R40039C17: got 'Pago de derechos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40040 / R40040C17: got 'Pago de derechos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40041 / R40041C17: got 'Pago de derechos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40042 / R40042C17: got 'Pago de derechos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40043 / R40043C17: got 'Pago de derechos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40044 / R40044C17: got 'Pago de derechos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40045 / R40045C17: got 'Pago de derechos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40046 / R40046C17: got 'Pago de derechos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40047 / R40047C17: got 'Pago de derechos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40048 / R40048C17: got 'Pipas'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40049 / R40049C17: got 'Diagnósticos, informes,\nreportes, opiniones técnicas'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40050 / R40050C17: got 'Infraestructura y obras'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40051 / R40051C17: got 'Impacto ambiental'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40052 / R40052C17: got 'Impacto ambiental'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40053 / R40053C17: got 'Infraestructura y obras'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40054 / R40054C17: got 'Infraestructura y obras'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40055 / R40055C17: got 'Diagnósticos, informes,\nreportes, opiniones técnicas'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40056 / R40056C17: got 'Presupuesto'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40057 / R40057C17: got 'Diagnósticos, informes,\nreportes, opiniones técnicas'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40058 / R40058C17: got 'Infraestructura y obras'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40059 / R40059C17: got 'Permisos y contratos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40060 / R40060C17: got 'Permisos y contratos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40061 / R40061C17: got 'Pipas'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40062 / R40062C17: got 'Diagnósticos, informes,\nreportes, opiniones técnicas'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40063 / R40063C17: got 'Diagnósticos, informes,\nreportes, opiniones técnicas'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40064 / R40064C17: got 'Mantenimiento y\nrehabilitación'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40065 / R40065C17: got 'Mantenimiento y\nrehabilitación'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40066 / R40066C17: got 'Diagnósticos, informes,\nreportes, opiniones técnicas'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40067 / R40067C17: got 'Abastecimiento'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40068 / R40068C17: got 'Permisos y contratos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40069 / R40069C17: got 'Impacto ambiental'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40070 / R40070C17: got 'Diagnósticos, informes,\nreportes, opiniones técnicas'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40071 / R40071C17: got 'Pago de derechos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40072 / R40072C17: got 'Diagnósticos, informes,\nreportes, opiniones técnicas'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40073 / R40073C17: got 'Abastecimiento'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40074 / R40074C17: got 'Abastecimiento'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40075 / R40075C17: got 'Mantenimiento y\nrehabilitación'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40076 / R40076C17: got 'Pago de derechos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40077 / R40077C17: got 'Permisos y contratos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40078 / R40078C17: got 'Mantenimiento y\nrehabilitación'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40079 / R40079C17: got 'Pago de derechos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40080 / R40080C17: got 'Diagnósticos, informes,\nreportes, opiniones técnicas'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40081 / R40081C17: got 'Infraestructura y obras'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40082 / R40082C17: got 'Pago de derechos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40083 / R40083C17: got 'Infraestructura y obras'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40084 / R40084C17: got 'Infraestructura y obras'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40085 / R40085C17: got 'Mantenimiento y\nrehabilitación'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40086 / R40086C17: got 'Diagnósticos, informes,\nreportes, opiniones técnicas'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40087 / R40087C17: got 'Presupuesto'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40088 / R40088C17: got 'Infraestructura y obras'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40089 / R40089C17: got 'Permisos y contratos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40090 / R40090C17: got 'Permisos y contratos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40091 / R40091C17: got 'Permisos y contratos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40092 / R40092C17: got 'Mantenimiento y\nrehabilitación'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40093 / R40093C17: got 'Pipas'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40094 / R40094C17: got 'Pipas'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40095 / R40095C17: got 'Pipas'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40096 / R40096C17: got 'Pipas'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40097 / R40097C17: got 'Pipas'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40098 / R40098C17: got 'Pipas'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40099 / R40099C17: got 'Pipas'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40100 / R40100C17: got 'Pipas'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40101 / R40101C17: got 'Pipas'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40102 / R40102C17: got 'Pipas'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40103 / R40103C17: got 'Pipas'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40104 / R40104C17: got 'Pipas'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40105 / R40105C17: got 'Pipas'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40106 / R40106C17: got 'Pipas'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40107 / R40107C17: got 'Pipas'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40108 / R40108C17: got 'Pipas'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40109 / R40109C17: got 'Pipas'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40110 / R40110C17: got 'Pipas'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40111 / R40111C17: got 'Pipas'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40112 / R40112C17: got 'Pipas'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40113 / R40113C17: got 'Pipas'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40114 / R40114C17: got 'Pipas'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40115 / R40115C17: got 'Pipas'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40116 / R40116C17: got 'Pipas'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40117 / R40117C17: got 'Pipas'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40118 / R40118C17: got 'Pipas'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40119 / R40119C17: got 'Pipas'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40120 / R40120C17: got 'Pipas'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40121 / R40121C17: got 'Pipas'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40122 / R40122C17: got 'Pipas'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40123 / R40123C17: got 'Pipas'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40124 / R40124C17: got 'Pipas'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40125 / R40125C17: got 'Pipas'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40126 / R40126C17: got 'Pipas'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40127 / R40127C17: got 'Pipas'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40128 / R40128C17: got 'Pipas'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40129 / R40129C17: got 'Pipas'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40130 / R40130C17: got 'Pipas'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40131 / R40131C17: got 'Pipas'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40132 / R40132C17: got 'Pipas'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40133 / R40133C17: got 'Pipas'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40134 / R40134C17: got 'Pipas'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40135 / R40135C17: got 'Pipas'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40136 / R40136C17: got 'Pipas'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40137 / R40137C17: got 'Pipas'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40138 / R40138C17: got 'Pipas'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40139 / R40139C17: got 'Pipas'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40140 / R40140C17: got 'Pipas'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40141 / R40141C17: got 'Pipas'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40142 / R40142C17: got 'Pipas'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40143 / R40143C17: got 'Pago de derechos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40144 / R40144C17: got 'Permisos y contratos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40145 / R40145C17: got 'Infraestructura y obras'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40146 / R40146C17: got 'Mantenimiento y\nrehabilitación'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40147 / R40147C17: got 'Pago de derechos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40148 / R40148C17: got 'Diagnósticos, informes,\nreportes, opiniones técnicas'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40149 / R40149C17: got 'Abastecimiento'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40150 / R40150C17: got 'Abastecimiento'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40151 / R40151C17: got 'Abastecimiento'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40152 / R40152C17: got 'Infraestructura y obras'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40153 / R40153C17: got 'Mantenimiento y\nrehabilitación'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40154 / R40154C17: got 'Diagnósticos, informes,\nreportes, opiniones técnicas'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40155 / R40155C17: got 'Abastecimiento'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40156 / R40156C17: got 'Infraestructura y obras'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40157 / R40157C17: got 'Permisos y contratos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40158 / R40158C17: got 'Permisos y contratos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40159 / R40159C17: got 'Pipas'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40160 / R40160C17: got 'Impacto ambiental'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40161 / R40161C17: got 'Abastecimiento'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40162 / R40162C17: got 'Pago de derechos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40163 / R40163C17: got 'Permisos y contratos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40164 / R40164C17: got 'Abastecimiento'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40165 / R40165C17: got 'Pipas'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40166 / R40166C17: got 'Impacto ambiental'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40167 / R40167C17: got 'Pago de derechos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40168 / R40168C17: got 'Permisos y contratos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40169 / R40169C17: got 'Diagnósticos, informes,\nreportes, opiniones técnicas'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40170 / R40170C17: got 'Infraestructura y obras'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40171 / R40171C17: got 'Abastecimiento'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40172 / R40172C17: got 'Abastecimiento'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40173 / R40173C17: got 'Abastecimiento'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40174 / R40174C17: got 'Pago de derechos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40175 / R40175C17: got 'Presupuesto'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40176 / R40176C17: got 'Pago de derechos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40177 / R40177C17: got 'Diagnósticos, informes,\nreportes, opiniones técnicas'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40178 / R40178C17: got 'Diagnósticos, informes,\nreportes, opiniones técnicas'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40179 / R40179C17: got 'Pipas'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40180 / R40180C17: got 'Infraestructura y obras'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40181 / R40181C17: got 'Presupuesto'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40182 / R40182C17: got 'Abastecimiento'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40183 / R40183C17: got 'Abastecimiento'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40184 / R40184C17: got 'Abastecimiento'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40185 / R40185C17: got 'Infraestructura y obras'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40186 / R40186C17: got 'Pago de derechos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40187 / R40187C17: got 'Permisos y contratos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40188 / R40188C17: got 'Pipas'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40189 / R40189C17: got 'Pago de derechos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40190 / R40190C17: got 'Permisos y contratos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40191 / R40191C17: got 'Infraestructura y obras'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40192 / R40192C17: got 'Diagnósticos, informes,\nreportes, opiniones técnicas'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40193 / R40193C17: got 'Abastecimiento'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40194 / R40194C17: got 'Mantenimiento y\nrehabilitación'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40195 / R40195C17: got 'Infraestructura y obras'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40196 / R40196C17: got 'Permisos y contratos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40197 / R40197C17: got 'Pipas'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40198 / R40198C17: got 'Pipas'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40199 / R40199C17: got 'Abastecimiento'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40200 / R40200C17: got 'Permisos y contratos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40201 / R40201C17: got 'Mantenimiento y\nrehabilitación'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40202 / R40202C17: got 'Abastecimiento'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40203 / R40203C17: got 'Pipas'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40204 / R40204C17: got 'Pipas'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40205 / R40205C17: got 'Infraestructura y obras'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40206 / R40206C17: got 'Mantenimiento y\nrehabilitación'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40207 / R40207C17: got 'Infraestructura y obras'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40208 / R40208C17: got 'Permisos y contratos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40209 / R40209C17: got 'Pago de derechos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40210 / R40210C17: got 'Abastecimiento'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40211 / R40211C17: got 'Infraestructura y obras'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40212 / R40212C17: got 'Permisos y contratos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40213 / R40213C17: got 'Pipas'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40214 / R40214C17: got 'Pipas'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40215 / R40215C17: got 'Pago de derechos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40216 / R40216C17: got 'Permisos y contratos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40217 / R40217C17: got 'Pago de derechos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40218 / R40218C17: got 'Permisos y contratos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40219 / R40219C17: got 'Mantenimiento y\nrehabilitación'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40220 / R40220C17: got 'Presupuesto'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40221 / R40221C17: got 'Infraestructura y obras'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40222 / R40222C17: got 'Abastecimiento'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40223 / R40223C17: got 'Infraestructura y obras'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40224 / R40224C17: got 'Permisos y contratos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40225 / R40225C17: got 'Permisos y contratos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40226 / R40226C17: got 'Infraestructura y obras'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40227 / R40227C17: got 'Abastecimiento'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40228 / R40228C17: got 'Diagnósticos, informes,\nreportes, opiniones técnicas'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40229 / R40229C17: got 'Permisos y contratos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40230 / R40230C17: got 'Permisos y contratos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40231 / R40231C17: got 'Abastecimiento'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40232 / R40232C17: got 'Permisos y contratos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40233 / R40233C17: got 'Permisos y contratos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40234 / R40234C17: got 'Permisos y contratos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40235 / R40235C17: got 'Permisos y contratos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40236 / R40236C17: got 'Permisos y contratos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40237 / R40237C17: got 'Infraestructura y obras'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40238 / R40238C17: got 'Permisos y contratos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40239 / R40239C17: got 'Infraestructura y obras'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40240 / R40240C17: got 'Infraestructura y obras'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40241 / R40241C17: got 'Infraestructura y obras'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40242 / R40242C17: got 'Permisos y contratos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40243 / R40243C17: got 'Permisos y contratos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40244 / R40244C17: got 'Permisos y contratos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40245 / R40245C17: got 'Infraestructura y obras'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40246 / R40246C17: got 'Infraestructura y obras'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40247 / R40247C17: got 'Permisos y contratos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40248 / R40248C17: got 'Permisos y contratos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40249 / R40249C17: got 'Permisos y contratos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40250 / R40250C17: got 'Infraestructura y obras'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40251 / R40251C17: got 'Abastecimiento'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40252 / R40252C17: got 'Permisos y contratos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40253 / R40253C17: got 'Permisos y contratos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40254 / R40254C17: got 'Infraestructura y obras'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40255 / R40255C17: got 'Infraestructura y obras'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40256 / R40256C17: got 'Infraestructura y obras'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40257 / R40257C17: got 'Mantenimiento y\nrehabilitación'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40258 / R40258C17: got 'Permisos y contratos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40259 / R40259C17: got 'Permisos y contratos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40260 / R40260C17: got 'Pago de derechos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40261 / R40261C17: got 'Permisos y contratos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40262 / R40262C17: got 'Mantenimiento y\nrehabilitación'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40263 / R40263C17: got 'Diagnósticos, informes,\nreportes, opiniones técnicas'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40264 / R40264C17: got 'Permisos y contratos'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40265 / R40265C17: got 'Infraestructura y obras'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40266 / R40266C17: got 'Infraestructura y obras'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40267 / R40267C17: got 'Abastecimiento'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40268 / R40268C17: got 'Mantenimiento y\nrehabilitación'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40269 / R40269C17: got 'Mantenimiento y\nrehabilitación'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Expecting logical in Q40270 / R40270C17: got 'Mantenimiento y\nrehabilitación'\n```\n:::\n:::\n\n\nEl código de arriba es solo un preprocesamiento/limpieza de la última base de datos.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata %>%\n    group_by(dependencia) %>%\n    count(sort = T) %>%\n    ungroup() %>%\n    filter(n > 1000) %>%\n    mutate(\n        dependencia = str_replace(\n            dependencia, \"Secretaría de Desarrollo Urbano y Vivienda\",\n            \"Secretaría de Desarrollo\\nUrbano y Vivienda\"\n        ),\n        dependencia = str_replace(\n            dependencia, \"Secretaría de Obras y Servicios\",\n            \"Secretaría de Obras\\ny Servicios\"\n        )\n    ) %>%\n    ggplot(aes(x = reorder(dependencia, n), y = n, fill = \"pink\")) +\n    geom_bar(stat = \"identity\") +\n    geom_text(aes(label = comma(n), vjust = 0.5, hjust = 1),\n        position = position_dodge(0.9),\n        size = 10\n    ) +\n    coord_flip() +\n    theme_bw() +\n    theme(\n        legend.position = \"none\",\n        text = element_text(size = 25)\n    ) +\n    labs(\n        title = \"Instituciones con más de 1,000 SIP\",\n        #     subtitle = \"\",\n        x = \"\", y = \"\"\n    )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\nEra evidente que al tratarse de un tema sobre agua en la Ciudad de México, la institución con mayor número de solicitudes al respecto iba a ser el Sistema de Aguas (SACMEX pa lxs cuates). Sin embargo, también es interesante ver que hay 7 alcaldías (antes delegaciones).\n\n\n::: {.cell}\n\n```{.r .cell-code}\naniomes <- data %>%\n    group_by(anio) %>%\n    count() %>%\n    ungroup()\n\nggplot(aniomes, aes(x = anio, y = n)) +\n    geom_point(size = 4) +\n    geom_line(linewidth = 1) +\n    geom_text(aes(label = comma(n), vjust = -.7),\n        position = position_dodge(1),\n        size = 8\n    ) +\n    theme_bw() +\n    theme(text = element_text(size = 25)) +\n    scale_x_continuous(breaks = seq(2006, 2022, by = 1)) +\n    labs(\n        title = \"Solicitudes por año\",\n        x = \"\", y = \"\"\n    )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\nSi vemos el número de solicitudes a lo largo del tiempo, en 2017 se registró el mayor número de solicitudes. En la siguiente gráfica, interactiva, se puede observar la desagregación por mes de cada año. Esto porque creo que hay un efecto de estacionalidad: es decir, si bien un año puede ser particularmente seco, como este 2024, pudo haber meses en los que el desabasto fue mayor. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nxmes <- data %>%\n    mutate(mes = month(fecha_de_ingreso)) %>%\n    group_by(anio, mes) %>%\n    count() %>%\n    ungroup() %>%\n    mutate(\n        grupo = as.Date(paste(anio, mes, \"01\", sep = \"-\"))\n    ) %>%\n    ggplot(aes(x = grupo, y = n)) +\n    geom_line() +\n    geom_point() +\n    scale_x_date(NULL,\n        breaks = breaks_width(\"1 year\"),\n        labels = label_date(\"%Y\")\n    ) +\n    scale_y_continuous(breaks = seq(0, 1500, by = 100)) +\n    theme_bw() +\n    theme(\n        axis.text.x = element_text(angle = 45, hjust = 0.9),\n        text = element_text(size = 35)\n    ) +\n    labs(\n        title = \"SIP por mes y año\",\n        x = \"\", y = \"\"\n    )\n\nplotly::ggplotly(xmes)\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"plotly html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-ab80430bfffaf313da20\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-ab80430bfffaf313da20\">{\"x\":{\"data\":[{\"x\":[13422,13453,13483,13514,13545,13573,13604,13634,13665,13695,13726,13757,13787,13818,13848,13879,13910,13939,13970,14000,14031,14061,14092,14123,14153,14184,14214,14245,14276,14304,14335,14365,14396,14426,14457,14488,14518,14549,14579,14610,14641,14669,14700,14730,14761,14791,14822,14853,14883,14914,14944,14975,15006,15034,15065,15095,15126,15156,15187,15218,15248,15279,15309,15340,15371,15400,15431,15461,15492,15522,15553,15584,15614,15645,15675,15706,15737,15765,15796,15826,15857,15887,15918,15949,15979,16010,16040,16071,16102,16130,16161,16191,16222,16252,16283,16314,16344,16375,16405,16436,16467,16495,16526,16556,16587,16617,16648,16679,16709,16740,16770,16801,16832,16861,16892,16922,16953,16983,17014,17045,17075,17106,17136,17167,17198,17226,17257,17287,17318,17348,17379,17410,17440,17471,17501,17532,17563,17591,17622,17652,17683,17713,17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078,18109,18140,18170,18201,18231,18262,18293,18322,18353,18383,18414,18444,18475,18506,18536,18567,18597,18628,18659,18687,18718,18748,18779,18809,18840,18871,18901,18932,18962,18993,19024,19052,19083,19113,19144,19174,19205,19236,19266,19297,19327],\"y\":[1,21,9,16,80,18,16,18,20,24,23,37,34,23,19,65,41,40,26,77,36,51,33,48,53,39,646,56,148,871,89,75,179,481,377,201,1190,225,70,194,195,252,162,86,219,241,152,462,202,179,192,114,137,219,70,270,146,98,121,176,140,206,373,242,245,217,63,202,143,125,101,155,111,164,44,86,190,70,104,127,161,133,108,57,238,126,138,198,111,243,347,137,212,109,147,112,358,285,202,263,262,260,188,137,205,151,225,192,160,255,116,173,346,251,298,319,225,215,151,278,199,181,87,120,363,259,358,427,250,516,862,690,523,340,219,392,345,229,668,323,258,328,378,262,551,167,118,218,243,239,328,246,222,196,178,175,387,217,272,235,364,181,106,102,104,159,246,125,371,216,104,114,164,202,207,311,241,174,215,174,127,148,74,110,198,251,168,150,232,439,209,332,353,352,114],\"text\":[\"grupo: 2006-10-01<br />n:    1\",\"grupo: 2006-11-01<br />n:   21\",\"grupo: 2006-12-01<br />n:    9\",\"grupo: 2007-01-01<br />n:   16\",\"grupo: 2007-02-01<br />n:   80\",\"grupo: 2007-03-01<br />n:   18\",\"grupo: 2007-04-01<br />n:   16\",\"grupo: 2007-05-01<br />n:   18\",\"grupo: 2007-06-01<br />n:   20\",\"grupo: 2007-07-01<br />n:   24\",\"grupo: 2007-08-01<br />n:   23\",\"grupo: 2007-09-01<br />n:   37\",\"grupo: 2007-10-01<br />n:   34\",\"grupo: 2007-11-01<br />n:   23\",\"grupo: 2007-12-01<br />n:   19\",\"grupo: 2008-01-01<br />n:   65\",\"grupo: 2008-02-01<br />n:   41\",\"grupo: 2008-03-01<br />n:   40\",\"grupo: 2008-04-01<br />n:   26\",\"grupo: 2008-05-01<br />n:   77\",\"grupo: 2008-06-01<br />n:   36\",\"grupo: 2008-07-01<br />n:   51\",\"grupo: 2008-08-01<br />n:   33\",\"grupo: 2008-09-01<br />n:   48\",\"grupo: 2008-10-01<br />n:   53\",\"grupo: 2008-11-01<br />n:   39\",\"grupo: 2008-12-01<br />n:  646\",\"grupo: 2009-01-01<br />n:   56\",\"grupo: 2009-02-01<br />n:  148\",\"grupo: 2009-03-01<br />n:  871\",\"grupo: 2009-04-01<br />n:   89\",\"grupo: 2009-05-01<br />n:   75\",\"grupo: 2009-06-01<br />n:  179\",\"grupo: 2009-07-01<br />n:  481\",\"grupo: 2009-08-01<br />n:  377\",\"grupo: 2009-09-01<br />n:  201\",\"grupo: 2009-10-01<br />n: 1190\",\"grupo: 2009-11-01<br />n:  225\",\"grupo: 2009-12-01<br />n:   70\",\"grupo: 2010-01-01<br />n:  194\",\"grupo: 2010-02-01<br />n:  195\",\"grupo: 2010-03-01<br />n:  252\",\"grupo: 2010-04-01<br />n:  162\",\"grupo: 2010-05-01<br />n:   86\",\"grupo: 2010-06-01<br />n:  219\",\"grupo: 2010-07-01<br />n:  241\",\"grupo: 2010-08-01<br />n:  152\",\"grupo: 2010-09-01<br />n:  462\",\"grupo: 2010-10-01<br />n:  202\",\"grupo: 2010-11-01<br />n:  179\",\"grupo: 2010-12-01<br />n:  192\",\"grupo: 2011-01-01<br />n:  114\",\"grupo: 2011-02-01<br />n:  137\",\"grupo: 2011-03-01<br />n:  219\",\"grupo: 2011-04-01<br />n:   70\",\"grupo: 2011-05-01<br />n:  270\",\"grupo: 2011-06-01<br />n:  146\",\"grupo: 2011-07-01<br />n:   98\",\"grupo: 2011-08-01<br />n:  121\",\"grupo: 2011-09-01<br />n:  176\",\"grupo: 2011-10-01<br />n:  140\",\"grupo: 2011-11-01<br />n:  206\",\"grupo: 2011-12-01<br />n:  373\",\"grupo: 2012-01-01<br />n:  242\",\"grupo: 2012-02-01<br />n:  245\",\"grupo: 2012-03-01<br />n:  217\",\"grupo: 2012-04-01<br />n:   63\",\"grupo: 2012-05-01<br />n:  202\",\"grupo: 2012-06-01<br />n:  143\",\"grupo: 2012-07-01<br />n:  125\",\"grupo: 2012-08-01<br />n:  101\",\"grupo: 2012-09-01<br />n:  155\",\"grupo: 2012-10-01<br />n:  111\",\"grupo: 2012-11-01<br />n:  164\",\"grupo: 2012-12-01<br />n:   44\",\"grupo: 2013-01-01<br />n:   86\",\"grupo: 2013-02-01<br />n:  190\",\"grupo: 2013-03-01<br />n:   70\",\"grupo: 2013-04-01<br />n:  104\",\"grupo: 2013-05-01<br />n:  127\",\"grupo: 2013-06-01<br />n:  161\",\"grupo: 2013-07-01<br />n:  133\",\"grupo: 2013-08-01<br />n:  108\",\"grupo: 2013-09-01<br />n:   57\",\"grupo: 2013-10-01<br />n:  238\",\"grupo: 2013-11-01<br />n:  126\",\"grupo: 2013-12-01<br />n:  138\",\"grupo: 2014-01-01<br />n:  198\",\"grupo: 2014-02-01<br />n:  111\",\"grupo: 2014-03-01<br />n:  243\",\"grupo: 2014-04-01<br />n:  347\",\"grupo: 2014-05-01<br />n:  137\",\"grupo: 2014-06-01<br />n:  212\",\"grupo: 2014-07-01<br />n:  109\",\"grupo: 2014-08-01<br />n:  147\",\"grupo: 2014-09-01<br />n:  112\",\"grupo: 2014-10-01<br />n:  358\",\"grupo: 2014-11-01<br />n:  285\",\"grupo: 2014-12-01<br />n:  202\",\"grupo: 2015-01-01<br />n:  263\",\"grupo: 2015-02-01<br />n:  262\",\"grupo: 2015-03-01<br />n:  260\",\"grupo: 2015-04-01<br />n:  188\",\"grupo: 2015-05-01<br />n:  137\",\"grupo: 2015-06-01<br />n:  205\",\"grupo: 2015-07-01<br />n:  151\",\"grupo: 2015-08-01<br />n:  225\",\"grupo: 2015-09-01<br />n:  192\",\"grupo: 2015-10-01<br />n:  160\",\"grupo: 2015-11-01<br />n:  255\",\"grupo: 2015-12-01<br />n:  116\",\"grupo: 2016-01-01<br />n:  173\",\"grupo: 2016-02-01<br />n:  346\",\"grupo: 2016-03-01<br />n:  251\",\"grupo: 2016-04-01<br />n:  298\",\"grupo: 2016-05-01<br />n:  319\",\"grupo: 2016-06-01<br />n:  225\",\"grupo: 2016-07-01<br />n:  215\",\"grupo: 2016-08-01<br />n:  151\",\"grupo: 2016-09-01<br />n:  278\",\"grupo: 2016-10-01<br />n:  199\",\"grupo: 2016-11-01<br />n:  181\",\"grupo: 2016-12-01<br />n:   87\",\"grupo: 2017-01-01<br />n:  120\",\"grupo: 2017-02-01<br />n:  363\",\"grupo: 2017-03-01<br />n:  259\",\"grupo: 2017-04-01<br />n:  358\",\"grupo: 2017-05-01<br />n:  427\",\"grupo: 2017-06-01<br />n:  250\",\"grupo: 2017-07-01<br />n:  516\",\"grupo: 2017-08-01<br />n:  862\",\"grupo: 2017-09-01<br />n:  690\",\"grupo: 2017-10-01<br />n:  523\",\"grupo: 2017-11-01<br />n:  340\",\"grupo: 2017-12-01<br />n:  219\",\"grupo: 2018-01-01<br />n:  392\",\"grupo: 2018-02-01<br />n:  345\",\"grupo: 2018-03-01<br />n:  229\",\"grupo: 2018-04-01<br />n:  668\",\"grupo: 2018-05-01<br />n:  323\",\"grupo: 2018-06-01<br />n:  258\",\"grupo: 2018-07-01<br />n:  328\",\"grupo: 2018-08-01<br />n:  378\",\"grupo: 2018-09-01<br />n:  262\",\"grupo: 2018-10-01<br />n:  551\",\"grupo: 2018-11-01<br />n:  167\",\"grupo: 2018-12-01<br />n:  118\",\"grupo: 2019-01-01<br />n:  218\",\"grupo: 2019-02-01<br />n:  243\",\"grupo: 2019-03-01<br />n:  239\",\"grupo: 2019-04-01<br />n:  328\",\"grupo: 2019-05-01<br />n:  246\",\"grupo: 2019-06-01<br />n:  222\",\"grupo: 2019-07-01<br />n:  196\",\"grupo: 2019-08-01<br />n:  178\",\"grupo: 2019-09-01<br />n:  175\",\"grupo: 2019-10-01<br />n:  387\",\"grupo: 2019-11-01<br />n:  217\",\"grupo: 2019-12-01<br />n:  272\",\"grupo: 2020-01-01<br />n:  235\",\"grupo: 2020-02-01<br />n:  364\",\"grupo: 2020-03-01<br />n:  181\",\"grupo: 2020-04-01<br />n:  106\",\"grupo: 2020-05-01<br />n:  102\",\"grupo: 2020-06-01<br />n:  104\",\"grupo: 2020-07-01<br />n:  159\",\"grupo: 2020-08-01<br />n:  246\",\"grupo: 2020-09-01<br />n:  125\",\"grupo: 2020-10-01<br />n:  371\",\"grupo: 2020-11-01<br />n:  216\",\"grupo: 2020-12-01<br />n:  104\",\"grupo: 2021-01-01<br />n:  114\",\"grupo: 2021-02-01<br />n:  164\",\"grupo: 2021-03-01<br />n:  202\",\"grupo: 2021-04-01<br />n:  207\",\"grupo: 2021-05-01<br />n:  311\",\"grupo: 2021-06-01<br />n:  241\",\"grupo: 2021-07-01<br />n:  174\",\"grupo: 2021-08-01<br />n:  215\",\"grupo: 2021-09-01<br />n:  174\",\"grupo: 2021-10-01<br />n:  127\",\"grupo: 2021-11-01<br />n:  148\",\"grupo: 2021-12-01<br />n:   74\",\"grupo: 2022-01-01<br />n:  110\",\"grupo: 2022-02-01<br />n:  198\",\"grupo: 2022-03-01<br />n:  251\",\"grupo: 2022-04-01<br />n:  168\",\"grupo: 2022-05-01<br />n:  150\",\"grupo: 2022-06-01<br />n:  232\",\"grupo: 2022-07-01<br />n:  439\",\"grupo: 2022-08-01<br />n:  209\",\"grupo: 2022-09-01<br />n:  332\",\"grupo: 2022-10-01<br />n:  353\",\"grupo: 2022-11-01<br />n:  352\",\"grupo: 2022-12-01<br />n:  114\"],\"type\":\"scatter\",\"mode\":\"lines+markers\",\"line\":{\"width\":1.88976377952756,\"color\":\"rgba(0,0,0,1)\",\"dash\":\"solid\"},\"hoveron\":\"points\",\"showlegend\":false,\"xaxis\":\"x\",\"yaxis\":\"y\",\"hoverinfo\":\"text\",\"marker\":{\"autocolorscale\":false,\"color\":\"rgba(0,0,0,1)\",\"opacity\":1,\"size\":5.66929133858268,\"symbol\":\"circle\",\"line\":{\"width\":1.88976377952756,\"color\":\"rgba(0,0,0,1)\"}},\"frame\":null}],\"layout\":{\"margin\":{\"t\":82.019095060191,\"r\":7.30593607305936,\"b\":57.5712530783046,\"l\":85.3466168534662},\"plot_bgcolor\":\"rgba(255,255,255,1)\",\"paper_bgcolor\":\"rgba(255,255,255,1)\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":46.4923204649232},\"title\":{\"text\":\"SIP por mes y año\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":55.7907845579079},\"x\":0,\"xref\":\"paper\"},\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[13126.75,19622.25],\"tickmode\":\"array\",\"ticktext\":[\"2006\",\"2007\",\"2008\",\"2009\",\"2010\",\"2011\",\"2012\",\"2013\",\"2014\",\"2015\",\"2016\",\"2017\",\"2018\",\"2019\",\"2020\",\"2021\",\"2022\",\"2023\"],\"tickvals\":[13149,13514,13879,14245,14610,14975,15340,15706,16071,16436,16801,17167,17532,17897,18262,18628,18993,19358],\"categoryorder\":\"array\",\"categoryarray\":[\"2006\",\"2007\",\"2008\",\"2009\",\"2010\",\"2011\",\"2012\",\"2013\",\"2014\",\"2015\",\"2016\",\"2017\",\"2018\",\"2019\",\"2020\",\"2021\",\"2022\",\"2023\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.65296803652968,\"tickwidth\":0.66417600664176,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":37.1938563719386},\"tickangle\":-45,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"gridcolor\":\"rgba(235,235,235,1)\",\"gridwidth\":0.66417600664176,\"zeroline\":false,\"anchor\":\"y\",\"title\":{\"text\":\"\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":46.4923204649232}},\"hoverformat\":\".2f\"},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"type\":\"linear\",\"autorange\":false,\"range\":[-58.45,1249.45],\"tickmode\":\"array\",\"ticktext\":[\"0\",\"100\",\"200\",\"300\",\"400\",\"500\",\"600\",\"700\",\"800\",\"900\",\"1000\",\"1100\",\"1200\"],\"tickvals\":[7.105427357601e-15,100,200,300,400,500,600,700,800,900,1000,1100,1200],\"categoryorder\":\"array\",\"categoryarray\":[\"0\",\"100\",\"200\",\"300\",\"400\",\"500\",\"600\",\"700\",\"800\",\"900\",\"1000\",\"1100\",\"1200\"],\"nticks\":null,\"ticks\":\"outside\",\"tickcolor\":\"rgba(51,51,51,1)\",\"ticklen\":3.65296803652968,\"tickwidth\":0.66417600664176,\"showticklabels\":true,\"tickfont\":{\"color\":\"rgba(77,77,77,1)\",\"family\":\"\",\"size\":37.1938563719386},\"tickangle\":-0,\"showline\":false,\"linecolor\":null,\"linewidth\":0,\"showgrid\":true,\"gridcolor\":\"rgba(235,235,235,1)\",\"gridwidth\":0.66417600664176,\"zeroline\":false,\"anchor\":\"x\",\"title\":{\"text\":\"\",\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":46.4923204649232}},\"hoverformat\":\".2f\"},\"shapes\":[{\"type\":\"rect\",\"fillcolor\":\"transparent\",\"line\":{\"color\":\"rgba(51,51,51,1)\",\"width\":0.66417600664176,\"linetype\":\"solid\"},\"yref\":\"paper\",\"xref\":\"paper\",\"x0\":0,\"x1\":1,\"y0\":0,\"y1\":1}],\"showlegend\":false,\"legend\":{\"bgcolor\":\"rgba(255,255,255,1)\",\"bordercolor\":\"transparent\",\"borderwidth\":1.88976377952756,\"font\":{\"color\":\"rgba(0,0,0,1)\",\"family\":\"\",\"size\":37.1938563719386}},\"hovermode\":\"closest\",\"barmode\":\"relative\"},\"config\":{\"doubleClick\":\"reset\",\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"source\":\"A\",\"attrs\":{\"4af066974626\":{\"x\":{},\"y\":{},\"type\":\"scatter\"},\"4af02ebe554d\":{\"x\":{},\"y\":{}}},\"cur_data\":\"4af066974626\",\"visdat\":{\"4af066974626\":[\"function (y) \",\"x\"],\"4af02ebe554d\":[\"function (y) \",\"x\"]},\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n:::\n:::\n\n\nDe las nueve categorías la que tuvo mayor número de solicitudes fue la de \"pago de derechos\", seguida de \"permisos y contratos\" y \"abastecimiento\". Las cifras varían con las del reporte porque se clasificó sin filtrar las solicitudes de la muestra.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data, aes(x = forcats::fct_infreq(as.factor(etiqueta)))) +\n    geom_bar(aes(fill = organo_de_gobierno)) +\n    geom_text(aes(label = comma(after_stat(count))),\n        stat = \"count\",\n        vjust = 0.5, hjust = 1,\n        position = position_dodge(0.9),\n        size = 10\n    ) +\n    theme_bw() +\n    theme(\n        legend.position = \"bottom\",\n        text = element_text(size = 25)\n    ) +\n    coord_flip() +\n    labs(\n        x = \"\", y = \"\",\n        fill = \"\",\n        title = \"Ámbito y grupos\"\n    )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nd1 <- data %>%\n    mutate(\n        estatus = case_when(\n            str_detect(estatus, regex(\"desechada\", ignore_case = T)) ~ \"Desechada\",\n            T ~ estatus\n        ),\n        estatus = case_when(\n            str_detect(estatus, regex(\"proceso|pendiente|espera\", ignore_case = T)) ~ \"En proceso\",\n            T ~ estatus\n        )\n    )\n\nggplot(d1, aes(x = forcats::fct_infreq(etiqueta))) +\n    geom_bar(aes(fill = estatus)) +\n    geom_text(aes(label = comma(after_stat(count))),\n        stat = \"count\",\n        vjust = 0.5, hjust = 1,\n        position = position_dodge(0.9),\n        size = 10\n    ) +\n    theme_bw() +\n    theme(\n        legend.position = \"bottom\",\n        text = element_text(size = 25)\n    ) +\n    coord_flip() +\n    labs(\n        x = \"\", y = \"\",\n        fill = \"Estatus\",\n        title = \"Estatus\"\n    )\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\nPor último, se observa que practicamente todas las solicitudes fueron respondidas, o estaban en proceso de. Sin embargo, esto no significa que las respuestas sean *útiles* para las personas. O bien, que respondan de manera satisfactoria de acuerdo a las personas solicitantes.\n\n## ¿Y qué más?\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/htmlwidgets-1.6.2/htmlwidgets.js\"></script>\r\n<script src=\"../../site_libs/plotly-binding-4.10.3/plotly.js\"></script>\r\n<script src=\"../../site_libs/typedarray-0.1/typedarray.min.js\"></script>\r\n<script src=\"../../site_libs/jquery-3.5.1/jquery.min.js\"></script>\r\n<link href=\"../../site_libs/crosstalk-1.2.0/css/crosstalk.min.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/crosstalk-1.2.0/js/crosstalk.min.js\"></script>\r\n<link href=\"../../site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/plotly-main-2.11.1/plotly-latest.min.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}