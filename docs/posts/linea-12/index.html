<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="David Humberto Jiménez S.">
<meta name="dcterms.date" content="2022-09-13">
<meta name="description" content="A un año del trágico accidente de la línea 12 del metro el equipo de Estado Abierto del INFO CDMX elaboró un reporte con información pública. En este post vamos a aprende a usar las API de datos abiertos (de CKAN) y analizar las solicitudes de información pública.">

<title>blog - A un año de la Línea 12 con la API del INFO</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="../../site_libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<script src="../../site_libs/plotly-binding-4.10.3/plotly.js"></script>
<script src="../../site_libs/typedarray-0.1/typedarray.min.js"></script>
<script src="../../site_libs/jquery-3.5.1/jquery.min.js"></script>
<link href="../../site_libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="../../site_libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="../../site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="../../site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">blog</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/dhumbertojs" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/dhumbertoj" rel="" target=""><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">A un año de la Línea 12 con la API del INFO</h1>
                  <div>
        <div class="description">
          A un año del trágico accidente de la línea 12 del metro el equipo de Estado Abierto del INFO CDMX elaboró un reporte con información pública. En este post vamos a aprende a usar las API de datos abiertos (de CKAN) y analizar las solicitudes de información pública.
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">code</div>
                <div class="quarto-category">visualization</div>
                <div class="quarto-category">politics</div>
                <div class="quarto-category">spanish</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>David Humberto Jiménez S. </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">September 13, 2022</p>
      </div>
    </div>
    
      <div>
      <div class="quarto-title-meta-heading">Modified</div>
      <div class="quarto-title-meta-contents">
        <p class="date-modified">November 30, 2023</p>
      </div>
    </div>
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="solicitudes-de-qué" class="level1">
<h1>Solicitudes de … qué?</h1>
<p>El 4 de julio de 2022 se presentó un <a href="https://infocdmx.org.mx/images/biblioteca/2022/Reporte%20Metro%20L12%202022%20V4.pdf">informe</a> de <strong>Solicitudes de Información Pública</strong> (SIP) sobre la Línea 12 del Metro en la Ciudad de México. En resumen, un tramo de la línea colapso por defectos en la construcción, las personas implicadas de su construcción están en puestos de gobierno y de toma de decisiones. Para sorpresa de nadie, los posibles implicados se están deslindando de responsabilidades y señalamientos.</p>
<p><strong>Pero</strong>, el informe se realizó con base en las SIP del 3 de mayo del 2021 al 11 de mayo de 2022, es decir: sobre lo que preguntan las personas a las instituciones de la Ciudad de México. Para ver la presentación pueden ver el siguiente <a href="https://www.youtube.com/watch?v=isYuKVApYpg">video</a> y si quieren pueden leerlo <a href="https://infocdmx.org.mx/images/biblioteca/2022/Reporte%20Metro%20L12%202022%20V4.pdf">aquí</a>.</p>
<p>Y hasta ahí todo sin pena ni gloria: todo es trágico, la gente pide información y a se le deja esperando que alguien le responda. Clásico de una democracia, ¿verdad? Pues así era, hasta que “alguien” se enojó y regaño a dos comisionados del Instituto desde donde se realizó el informe. ¿Y la autonomía a’pá?</p>
<p>Si no me creen, vean este <a href="https://youtu.be/JtS3TBjBSLE?t=6672">video</a> donde en el pleno los comisionados, <em>cofcofmachitoscofcof</em>, continúan con la línea establecida por el gobierno, ofrecen <em>otros datos</em> (sello de esta era política): mayor número de solicitudes (porque evidentemente más preguntas significa más transparencia), y que más del <strong>95%</strong> han sido respondidas.</p>
<p>¿Qué significa haber respondido una solicitud de transparencia? Más adelante hay un párrafo sobre algunos hallazgos sobre las respuestas de <em>esta</em> base de datos. Además, si conocen de transparencia saben que una posible respuesta es que esa institución <strong>no</strong> tiene esa información. En aproximadamente la mitad de los casos no sabemos qué respondió el sujeto obligado.</p>
<p>En fin, este no es un rant, este es un blog de datos y eso es lo que haremos. Dado que ya se publicaron las SIP que se utilizaron en el informe, vamos a replicar las gráficas y ver que otra cosa sale.</p>
<section id="análisis" class="level2">
<h2 class="anchored" data-anchor-id="análisis">Análisis</h2>
<p>Entonces, a mi me gusta llamar primero a las <em>libraries</em> que vamos a utilizar, luego los datos y empezar a explorar.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: NLP</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(httr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'httr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:NLP':

    content</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: ggplot2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'ggplot2'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:NLP':

    annotate</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'plotly'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:ggplot2':

    last_plot</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:httr':

    config</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:stats':

    filter</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:graphics':

    layout</code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(xtable)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(syuzhet)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(jsonlite)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidytext)</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'lubridate'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    date, intersect, setdiff, union</code></pre>
</div>
</div>
<p>Ahora, podemos hacer lo de siempre y descargar los datos, importarlos y limpiarlos. Pero, como el punto de todo esto es aprender a hacer cosas nuevas vamos a leer la API de los datos abiertos del <a href="https://datosabiertos.infocdmx.org.mx/dataset/linea-12-del-metro/resource/07fff148-a1bf-4fb7-9ed0-ed66b6907890">INFO</a>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://i.postimg.cc/HsqCBdMQ/2022-09-12.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Así debe verse</figcaption>
</figure>
</div>
<p>Le damos clic en explorar</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://i.postimg.cc/N0YFC1X7/2022-09-12-1.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Nueva pantalla…</figcaption>
</figure>
</div>
<p>Y en el botón verde que dice “API de datos” le damos clic y se verá de la siguiente manera:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://i.postimg.cc/C15F9JxD/2022-09-12-2.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Ta-dá!</figcaption>
</figure>
</div>
<p>Seleccionamos lo que está subrayado (así como queda en el código de abajo) que es el enlace que necesitamos para “llamar” a los datos. Para revisar por qué hice esto pueden checar el trabajo de <a href="https://www.r-bloggers.com/2019/06/getting-open-data-into-r-from-ckan/">Alan Yeung</a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="st">"https://datosabiertos.infocdmx.org.mx/api/3/action/datastore_search?resource_id=07fff148-a1bf-4fb7-9ed0-ed66b6907890"</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>raw <span class="ot">&lt;-</span> <span class="fu">GET</span>(url)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">status_code</span>(raw)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 200</code></pre>
</div>
</div>
<p>Debe salir 200 para saber que se logró llamar a la información, si sale otra cosa vean el blog ya mencionado. Ambas funciones, <em>GET</em> y <em>status_code</em>, son del paquete <em>httr</em>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>obs <span class="ot">&lt;-</span> <span class="st">"&amp;limit=1807"</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="fu">paste0</span>(url, obs)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>lista <span class="ot">&lt;-</span> <span class="fu">fromJSON</span>(url)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> lista<span class="sc">$</span>result<span class="sc">$</span>records</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Por default la consulta tiene un límite de 100 observaciones, por eso a la <em>url</em> hay que agregarle el string <em>&amp;limit=</em> donde el número es el total de observaciones que hay publicadas. Y del paquete <em>jsonlite</em> la función <em>fromJSON</em> nos permite obtener los datos (records). Y listo! Con estas instrucciones ya podemos utilizar todas los <em>datasets</em> que tiene publicados el INFO.</p>
</section>
<section id="análisis-básico" class="level2">
<h2 class="anchored" data-anchor-id="análisis-básico">Análisis básico</h2>
<p>Ya teniendo los datos listos, podemos hacer análisis adicionales a lo que se presenta en el <a href="https://infocdmx.org.mx/images/biblioteca/2022/Reporte%20Metro%20L12%202022%20V4.pdf">reporte</a> (desde la página 17). Particularmente quiero explorar los textos y alguna cosa que se me vaya ocurriendo.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "_id"                         "folio"                      
 [3] "fecha_de_ingreso"            "descripcion_de_la_solicitud"
 [5] "estatus"                     "medio_entrada"              
 [7] "tipo_solicitud"              "fecha_limite_de_respuesta"  
 [9] "respuesta"                   "dependencia"                
[11] "organo_de_gobierno"         </code></pre>
</div>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>data <span class="sc">%&gt;%</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(dependencia, <span class="at">sort =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">top_n</span>(<span class="dv">10</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xtable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="at">type =</span> <span class="st">"html"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<pre><code>Selecting by n</code></pre>

<!-- html table generated in R 4.2.2 by xtable 1.8-4 package -->
<!-- Mon Dec  4 14:47:29 2023 -->

<table border="1">
<tbody><tr>
<th>
</th>
<th>
dependencia
</th>
<th>
n
</th>
</tr>
<tr>
<td align="right">
1
</td>
<td>
Sistema de Transporte Colectivo
</td>
<td align="right">
459
</td>
</tr>
<tr>
<td align="right">
2
</td>
<td>
Jefatura de Gobierno de la Ciudad de México
</td>
<td align="right">
398
</td>
</tr>
<tr>
<td align="right">
3
</td>
<td>
Secretaría de Obras y Servicios
</td>
<td align="right">
196
</td>
</tr>
<tr>
<td align="right">
4
</td>
<td>
Secretaría de Gestión Integral de Riesgos y Protección Civil
</td>
<td align="right">
142
</td>
</tr>
<tr>
<td align="right">
5
</td>
<td>
Fiscalía General de Justicia de la CDMX
</td>
<td align="right">
66
</td>
</tr>
<tr>
<td align="right">
6
</td>
<td>
Secretaría de Movilidad
</td>
<td align="right">
62
</td>
</tr>
<tr>
<td align="right">
7
</td>
<td>
Secretaría de la Contraloría General
</td>
<td align="right">
56
</td>
</tr>
<tr>
<td align="right">
8
</td>
<td>
Secretaría de Gobierno
</td>
<td align="right">
49
</td>
</tr>
<tr>
<td align="right">
9
</td>
<td>
Secretaría de Administración y Finanzas
</td>
<td align="right">
37
</td>
</tr>
<tr>
<td align="right">
10
</td>
<td>
Comisión Ejecutiva de Atención a Víctimas de la Ciudad de México
</td>
<td align="right">
35
</td>
</tr>

</tbody></table>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>data <span class="sc">%&gt;%</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(organo_de_gobierno, <span class="at">sort =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xtable</span>() <span class="sc">%&gt;%</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="at">type =</span> <span class="st">"html"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

<!-- html table generated in R 4.2.2 by xtable 1.8-4 package -->
<!-- Mon Dec  4 14:47:29 2023 -->

<table border="1">
<tbody><tr>
<th>
</th>
<th>
organo_de_gobierno
</th>
<th>
n
</th>
</tr>
<tr>
<td align="right">
1
</td>
<td>
Administración Pública Central
</td>
<td align="right">
998
</td>
</tr>
<tr>
<td align="right">
2
</td>
<td>
Organismos desconcentrados, descentralizados, paraestatales y auxiliares
</td>
<td align="right">
563
</td>
</tr>
<tr>
<td align="right">
3
</td>
<td>
Órganos Autónomos
</td>
<td align="right">
109
</td>
</tr>
<tr>
<td align="right">
4
</td>
<td>
Poder Legislativo
</td>
<td align="right">
47
</td>
</tr>
<tr>
<td align="right">
5
</td>
<td>
Sindicatos
</td>
<td align="right">
41
</td>
</tr>
<tr>
<td align="right">
6
</td>
<td>
Alcaldías
</td>
<td align="right">
36
</td>
</tr>
<tr>
<td align="right">
7
</td>
<td>
Partidos Políticos
</td>
<td align="right">
6
</td>
</tr>
<tr>
<td align="right">
8
</td>
<td>
Poder Judicial
</td>
<td align="right">
5
</td>
</tr>
<tr>
<td align="right">
9
</td>
<td>
Fideicomisos y fondos públicos
</td>
<td align="right">
2
</td>
</tr>

</tbody></table>
<p>Es evidente, que el Sistema de Transporte Colectivo (metro) iba a ser el sujeto obligado con más solicitudes de información pública sobre el tema.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># data %&gt;%</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   count(respuesta)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>De las 1,807 solicitudes, hay 281 grupos de respuestas, y si empezamos a revisar vemos que los grupos se pueden reducir… No estaba en el plan, pero estaría interesante para revisar. Dado que se ve gigantesco, chéquenlo con calma en su equipo. Pero, a bote pronto, hay 600 solicitudes sin respuesta (<strong>33%</strong>), 444 (<strong>25%</strong>) se contestaron vía infomex (descanse en paz) o por la Plataforma Nacional de Transparencia (pero no sabemos que se respondió); 188 (<strong>10%</strong>) dijeron que la solicitud le corresponde a otro ente <strong>OJO</strong> este es el texto directo sin adornos abogadiles (nada contra ustedes; sin embargo, nadie entiende como escriben). 79 (<strong>4%</strong>) fueron prevenidas (esto significa que a las personas servidoras públicas no les quedó clara la, o las, preguntas y le piden más información a la persona solicitante) y 51 (<strong>3%</strong>) se declararon incompetentes para responder y 26 (<strong>1%</strong>) se reservaron, esto significa que es información que poseen las instituciones y que por motivos de seguridad no puede ser entregada por un tiempo determinado.</p>
<p>Después de todo ese rollo, falta 26% de las solicitudes… que están en <em>abogañol</em> o que no se puede clasificar en un ratito. Si quieren ayuda envíenme un <a href="https://twitter.com/dhumbertoj">DM</a> Las cifras las fui sacando de medio leer los resultados en una hoja de Excel :P</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>dias <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">dia =</span> <span class="fu">date</span>(fecha_de_ingreso)) <span class="sc">%&gt;%</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(dia) <span class="sc">%&gt;%</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> dia, <span class="at">y =</span> n)) <span class="sc">+</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">""</span>,</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"Solicitudes por día"</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>()</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplotly</span>(dias)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-0c37a8d48d9971f79b3c" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-0c37a8d48d9971f79b3c">{"x":{"data":[{"x":[18750,18751,18752,18753,18754,18755,18756,18757,18758,18759,18760,18761,18762,18763,18764,18765,18766,18767,18768,18769,18770,18771,18772,18773,18774,18775,18776,18777,18778,18780,18781,18782,18783,18785,18786,18787,18788,18789,18793,18794,18795,18796,18799,18801,18802,18803,18804,18805,18807,18808,18809,18810,18813,18814,18815,18816,18817,18820,18821,18822,18824,18827,18828,18829,18830,18834,18835,18841,18842,18844,18850,18851,18852,18853,18856,18857,18858,18859,18862,18863,18864,18865,18868,18869,18870,18871,18872,18873,18876,18877,18878,18879,18880,18882,18884,18885,18886,18887,18891,18893,18898,18900,18905,18906,18910,18913,18915,18919,18922,18924,18925,18926,18927,18933,18934,18940,18941,18943,18946,18947,18951,18952,18953,18955,18960,18961,18970,18972,18976,18981,18984,18988,19002,19003,19009,19011,19012,19013,19014,19019,19020,19023,19025,19026,19030,19031,19033,19034,19038,19039,19041,19045,19048,19050,19051,19052,19053,19054,19055,19056,19060,19064,19065,19066,19067,19068,19069,19073,19074,19075,19076,19077,19079,19080,19081,19082,19083,19086,19088,19089,19101,19102,19103,19107,19109,19110,19111,19114,19115,19116,19117,19118,19119,19120,19121,19122,19123],"y":[6,66,27,52,5,3,4,11,15,16,25,8,4,2,11,6,14,16,16,13,1,5,2,21,8,5,1,2,5,8,7,22,2,12,8,4,8,2,4,4,10,4,16,10,5,5,1,1,4,1,2,8,13,2,11,3,14,2,6,6,3,5,3,3,2,1,1,3,3,2,3,3,2,3,2,6,3,5,2,9,3,9,2,14,16,4,1,8,6,11,2,2,3,1,4,4,5,1,8,1,3,2,2,5,2,7,1,5,2,3,3,3,2,3,1,16,5,2,8,1,1,4,6,3,4,4,2,1,5,11,8,4,1,12,3,5,1,1,1,4,1,1,2,5,13,5,2,9,2,4,1,7,2,5,8,4,5,1,3,1,2,9,17,9,5,9,11,5,5,3,3,5,3,2,2,2,1,3,1,1,5,1,1,2,8,1,5,2,11,43,186,221,21,8,61,125,26],"text":["dia: 2021-05-03<br />n:   6","dia: 2021-05-04<br />n:  66","dia: 2021-05-05<br />n:  27","dia: 2021-05-06<br />n:  52","dia: 2021-05-07<br />n:   5","dia: 2021-05-08<br />n:   3","dia: 2021-05-09<br />n:   4","dia: 2021-05-10<br />n:  11","dia: 2021-05-11<br />n:  15","dia: 2021-05-12<br />n:  16","dia: 2021-05-13<br />n:  25","dia: 2021-05-14<br />n:   8","dia: 2021-05-15<br />n:   4","dia: 2021-05-16<br />n:   2","dia: 2021-05-17<br />n:  11","dia: 2021-05-18<br />n:   6","dia: 2021-05-19<br />n:  14","dia: 2021-05-20<br />n:  16","dia: 2021-05-21<br />n:  16","dia: 2021-05-22<br />n:  13","dia: 2021-05-23<br />n:   1","dia: 2021-05-24<br />n:   5","dia: 2021-05-25<br />n:   2","dia: 2021-05-26<br />n:  21","dia: 2021-05-27<br />n:   8","dia: 2021-05-28<br />n:   5","dia: 2021-05-29<br />n:   1","dia: 2021-05-30<br />n:   2","dia: 2021-05-31<br />n:   5","dia: 2021-06-02<br />n:   8","dia: 2021-06-03<br />n:   7","dia: 2021-06-04<br />n:  22","dia: 2021-06-05<br />n:   2","dia: 2021-06-07<br />n:  12","dia: 2021-06-08<br />n:   8","dia: 2021-06-09<br />n:   4","dia: 2021-06-10<br />n:   8","dia: 2021-06-11<br />n:   2","dia: 2021-06-15<br />n:   4","dia: 2021-06-16<br />n:   4","dia: 2021-06-17<br />n:  10","dia: 2021-06-18<br />n:   4","dia: 2021-06-21<br />n:  16","dia: 2021-06-23<br />n:  10","dia: 2021-06-24<br />n:   5","dia: 2021-06-25<br />n:   5","dia: 2021-06-26<br />n:   1","dia: 2021-06-27<br />n:   1","dia: 2021-06-29<br />n:   4","dia: 2021-06-30<br />n:   1","dia: 2021-07-01<br />n:   2","dia: 2021-07-02<br />n:   8","dia: 2021-07-05<br />n:  13","dia: 2021-07-06<br />n:   2","dia: 2021-07-07<br />n:  11","dia: 2021-07-08<br />n:   3","dia: 2021-07-09<br />n:  14","dia: 2021-07-12<br />n:   2","dia: 2021-07-13<br />n:   6","dia: 2021-07-14<br />n:   6","dia: 2021-07-16<br />n:   3","dia: 2021-07-19<br />n:   5","dia: 2021-07-20<br />n:   3","dia: 2021-07-21<br />n:   3","dia: 2021-07-22<br />n:   2","dia: 2021-07-26<br />n:   1","dia: 2021-07-27<br />n:   1","dia: 2021-08-02<br />n:   3","dia: 2021-08-03<br />n:   3","dia: 2021-08-05<br />n:   2","dia: 2021-08-11<br />n:   3","dia: 2021-08-12<br />n:   3","dia: 2021-08-13<br />n:   2","dia: 2021-08-14<br />n:   3","dia: 2021-08-17<br />n:   2","dia: 2021-08-18<br />n:   6","dia: 2021-08-19<br />n:   3","dia: 2021-08-20<br />n:   5","dia: 2021-08-23<br />n:   2","dia: 2021-08-24<br />n:   9","dia: 2021-08-25<br />n:   3","dia: 2021-08-26<br />n:   9","dia: 2021-08-29<br />n:   2","dia: 2021-08-30<br />n:  14","dia: 2021-08-31<br />n:  16","dia: 2021-09-01<br />n:   4","dia: 2021-09-02<br />n:   1","dia: 2021-09-03<br />n:   8","dia: 2021-09-06<br />n:   6","dia: 2021-09-07<br />n:  11","dia: 2021-09-08<br />n:   2","dia: 2021-09-09<br />n:   2","dia: 2021-09-10<br />n:   3","dia: 2021-09-12<br />n:   1","dia: 2021-09-14<br />n:   4","dia: 2021-09-15<br />n:   4","dia: 2021-09-16<br />n:   5","dia: 2021-09-17<br />n:   1","dia: 2021-09-21<br />n:   8","dia: 2021-09-23<br />n:   1","dia: 2021-09-28<br />n:   3","dia: 2021-09-30<br />n:   2","dia: 2021-10-05<br />n:   2","dia: 2021-10-06<br />n:   5","dia: 2021-10-10<br />n:   2","dia: 2021-10-13<br />n:   7","dia: 2021-10-15<br />n:   1","dia: 2021-10-19<br />n:   5","dia: 2021-10-22<br />n:   2","dia: 2021-10-24<br />n:   3","dia: 2021-10-25<br />n:   3","dia: 2021-10-26<br />n:   3","dia: 2021-10-27<br />n:   2","dia: 2021-11-02<br />n:   3","dia: 2021-11-03<br />n:   1","dia: 2021-11-09<br />n:  16","dia: 2021-11-10<br />n:   5","dia: 2021-11-12<br />n:   2","dia: 2021-11-15<br />n:   8","dia: 2021-11-16<br />n:   1","dia: 2021-11-20<br />n:   1","dia: 2021-11-21<br />n:   4","dia: 2021-11-22<br />n:   6","dia: 2021-11-24<br />n:   3","dia: 2021-11-29<br />n:   4","dia: 2021-11-30<br />n:   4","dia: 2021-12-09<br />n:   2","dia: 2021-12-11<br />n:   1","dia: 2021-12-15<br />n:   5","dia: 2021-12-20<br />n:  11","dia: 2021-12-23<br />n:   8","dia: 2021-12-27<br />n:   4","dia: 2022-01-10<br />n:   1","dia: 2022-01-11<br />n:  12","dia: 2022-01-17<br />n:   3","dia: 2022-01-19<br />n:   5","dia: 2022-01-20<br />n:   1","dia: 2022-01-21<br />n:   1","dia: 2022-01-22<br />n:   1","dia: 2022-01-27<br />n:   4","dia: 2022-01-28<br />n:   1","dia: 2022-01-31<br />n:   1","dia: 2022-02-02<br />n:   2","dia: 2022-02-03<br />n:   5","dia: 2022-02-07<br />n:  13","dia: 2022-02-08<br />n:   5","dia: 2022-02-10<br />n:   2","dia: 2022-02-11<br />n:   9","dia: 2022-02-15<br />n:   2","dia: 2022-02-16<br />n:   4","dia: 2022-02-18<br />n:   1","dia: 2022-02-22<br />n:   7","dia: 2022-02-25<br />n:   2","dia: 2022-02-27<br />n:   5","dia: 2022-02-28<br />n:   8","dia: 2022-03-01<br />n:   4","dia: 2022-03-02<br />n:   5","dia: 2022-03-03<br />n:   1","dia: 2022-03-04<br />n:   3","dia: 2022-03-05<br />n:   1","dia: 2022-03-09<br />n:   2","dia: 2022-03-13<br />n:   9","dia: 2022-03-14<br />n:  17","dia: 2022-03-15<br />n:   9","dia: 2022-03-16<br />n:   5","dia: 2022-03-17<br />n:   9","dia: 2022-03-18<br />n:  11","dia: 2022-03-22<br />n:   5","dia: 2022-03-23<br />n:   5","dia: 2022-03-24<br />n:   3","dia: 2022-03-25<br />n:   3","dia: 2022-03-26<br />n:   5","dia: 2022-03-28<br />n:   3","dia: 2022-03-29<br />n:   2","dia: 2022-03-30<br />n:   2","dia: 2022-03-31<br />n:   2","dia: 2022-04-01<br />n:   1","dia: 2022-04-04<br />n:   3","dia: 2022-04-06<br />n:   1","dia: 2022-04-07<br />n:   1","dia: 2022-04-19<br />n:   5","dia: 2022-04-20<br />n:   1","dia: 2022-04-21<br />n:   1","dia: 2022-04-25<br />n:   2","dia: 2022-04-27<br />n:   8","dia: 2022-04-28<br />n:   1","dia: 2022-04-29<br />n:   5","dia: 2022-05-02<br />n:   2","dia: 2022-05-03<br />n:  11","dia: 2022-05-04<br />n:  43","dia: 2022-05-05<br />n: 186","dia: 2022-05-06<br />n: 221","dia: 2022-05-07<br />n:  21","dia: 2022-05-08<br />n:   8","dia: 2022-05-09<br />n:  61","dia: 2022-05-10<br />n: 125","dia: 2022-05-11<br />n:  26"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,0,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":43.7625570776256,"r":7.30593607305936,"b":25.5707762557078,"l":28.4931506849315},"plot_bgcolor":"rgba(255,255,255,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"title":{"text":"Solicitudes por día","font":{"color":"rgba(0,0,0,1)","family":"","size":17.5342465753425},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[18731.35,19141.65],"tickmode":"array","ticktext":["jul. 2021","oct. 2021","ene. 2022","abr. 2022"],"tickvals":[18809,18901,18993,19083],"categoryorder":"array","categoryarray":["jul. 2021","oct. 2021","ene. 2022","abr. 2022"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"y","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-10,232],"tickmode":"array","ticktext":["0","50","100","150","200"],"tickvals":[0,50,100,150,200],"categoryorder":"array","categoryarray":["0","50","100","150","200"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":true,"linecolor":"rgba(0,0,0,1)","linewidth":0.66417600664176,"showgrid":false,"gridcolor":null,"gridwidth":0,"zeroline":false,"anchor":"x","title":{"text":"","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"507449ed36c0":{"x":{},"y":{},"type":"scatter"}},"cur_data":"507449ed36c0","visdat":{"507449ed36c0":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>El pico de solicitudes está el 5 de junio de 2022. En blogs pasados, específicamente en el análisis de <a href="https://dhumbertojs.github.io/posts/2020-12-09-das-sin-ti-anlisis-de-texto/">“Días sin ti”</a> utilicé gráficas interactivas, donde podías hacer zoom y te daba información básica de la observación, aquí utilizo la misma técnica.</p>
</section>
<section id="análisis-de-texto" class="level2">
<h2 class="anchored" data-anchor-id="análisis-de-texto">Análisis de texto</h2>
<p>Algo que no va a ser muy riguroso es el análisis de texto, por qué? Porque las solicitudes de información se caracterizan por ser texto libre y contener, en algunos casos, datos personales. Si bien este dataset tiene testados los datos personales, estos son reemplazados por asteriscos. Aun así, espero encontrar algo interesante.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>texto <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(descripcion_de_la_solicitud) <span class="sc">%&gt;%</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">unnest_tokens</span>(palabra, descripcion_de_la_solicitud) <span class="sc">%&gt;%</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">palabra =</span> <span class="fu">str_replace_all</span>(palabra, <span class="fu">c</span>(<span class="st">"á"</span> <span class="ot">=</span> <span class="st">"a"</span>, <span class="st">"é"</span> <span class="ot">=</span> <span class="st">"e"</span>, <span class="st">"í"</span> <span class="ot">=</span> <span class="st">"i"</span>, <span class="st">"ó"</span> <span class="ot">=</span> <span class="st">"o"</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span>palabra <span class="sc">%in%</span> <span class="fu">stopwords</span>(<span class="st">"es"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span>palabra <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"metro"</span>, <span class="st">"12"</span>, <span class="st">"sistema"</span>, <span class="st">"transporte"</span>, <span class="st">"colectivo"</span>, <span class="st">"ciudad"</span>, <span class="st">"mexico"</span>, <span class="st">"solicito"</span>, <span class="st">"3"</span>, <span class="st">"linea"</span>, <span class="st">"informacion"</span>, <span class="st">"cdmx"</span>, <span class="st">"2021"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Esto ya se la saben, limpieza de textos para tener solo palabras. Ahora, mientras redactaba esto, salieron palabras comunes que son demasiado obvias: metro, 12, línea, sistema, transporte, colectivo, etc. Por eso las filtro antes</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>texto <span class="sc">%&gt;%</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(palabra, <span class="at">sort =</span> T) <span class="sc">%&gt;%</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">top_n</span>(<span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Selecting by n</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>         palabra    n
1        empresa 1174
2           mayo 1067
3            dnv  886
4  mantenimiento  759
5          copia  717
6        informe  652
7          tramo  610
8   construccion  598
9          fecha  569
10      dictamen  543
11       colapso  539
12     accidente  508
13      gobierno  493
14      contrato  451
15   expedientes  448
16          obra  444
17      respecto  432
18      ocurrido  431
19    documentos  417
20        trenes  415</code></pre>
</div>
</div>
<p>Ahora, el análisis de sentimiento con Syuzhet, que es unir dos dataframes.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>texto_nrc <span class="ot">&lt;-</span> <span class="fu">get_nrc_sentiment</span>(<span class="at">char_v =</span> texto<span class="sc">$</span>palabra, <span class="at">language =</span> <span class="st">"spanish"</span>)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>texto_fin <span class="ot">&lt;-</span> <span class="fu">bind_cols</span>(texto, texto_nrc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>texto_fin <span class="sc">%&gt;%</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">cols =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">11</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(name) <span class="sc">%&gt;%</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">total =</span> <span class="fu">sum</span>(value)) <span class="sc">%&gt;%</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">name =</span> <span class="fu">reorder</span>(name, total)) <span class="sc">%&gt;%</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> name, <span class="at">y =</span> total, <span class="at">fill =</span> name)) <span class="sc">+</span></span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(</span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">breaks =</span> <span class="fu">c</span>(<span class="st">"disgust"</span>, <span class="st">"surprise"</span>, <span class="st">"anger"</span>, <span class="st">"joy"</span>, <span class="st">"anticipation"</span>, <span class="st">"fear"</span>, <span class="st">"sadness"</span>, <span class="st">"trust"</span>, <span class="st">"positive"</span>, <span class="st">"negative"</span>),</span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#24D204"</span>, <span class="st">"#06CBBE"</span>, <span class="st">"#CB0606"</span>, <span class="st">"#FBFE00"</span>, <span class="st">"#FF9200"</span>, <span class="st">"#46BF5F"</span>, <span class="st">"#5479C3"</span>, <span class="st">"#01FF4C"</span>, <span class="st">"#FF00DC"</span>, <span class="st">"#000000"</span>)</span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"Análisis de sentimientos"</span>,</span>
<span id="cb37-18"><a href="#cb37-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">subtitle =</span> <span class="st">"Syuzhet"</span>,</span>
<span id="cb37-19"><a href="#cb37-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">""</span></span>
<span id="cb37-20"><a href="#cb37-20" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb37-21"><a href="#cb37-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"blank"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Resalta que la mayoría de las palabras tienen un sentido negativo… Lo cual tiene cierta lógica, uno no pide información porque ande feliz. Por otro lado, también es sorprendente que no haya tantas palabras relacionadas con el enojo… Si quieren entender que está pasando detrás, vean la documentación de <a href="https://cran.r-project.org/web/packages/syuzhet/vignettes/syuzhet-vignette.html">Syuzhet</a>.</p>
<p>Si a alguien se le ocurre algo más que se pueda hacer, hágamelo saber. Por ahora, creo que esto nos da en qué pensar. Si bien es limitado el número de variables en estas bases de datos, mientras más análisis se realicen con esta información se podrán aprovechar mejor. O bien, nos daremos cuenta de que información hace falta y se podría solicitar que se libere.</p>
<p>Muchas gracias a <a href="https://twitter.com/zuleeoviedo">Zule</a> por su lectura y recomendaciones para que este texto sea más entendible.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>