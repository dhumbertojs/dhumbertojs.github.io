<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="David Humberto Jiménez S.">
<meta name="dcterms.date" content="2018-04-18">
<meta name="description" content="Mini tutorial de como utilizar datos cargados en un google drive en formato csv">

<title>blog - Interrupción Legal del Embarazo en la Ciudad de México</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

<script src="../../site_libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<link href="../../site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="../../site_libs/datatables-binding-0.30/datatables.js"></script>
<script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="../../site_libs/dt-core-1.13.4/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="../../site_libs/dt-core-1.13.4/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="../../site_libs/dt-core-1.13.4/js/jquery.dataTables.min.js"></script>
<link href="../../site_libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="../../site_libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">blog</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text">About me</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/dhumbertojs" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/dhumbertoj" rel="" target=""><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Interrupción Legal del Embarazo en la Ciudad de México</h1>
                  <div>
        <div class="description">
          Mini tutorial de como utilizar datos cargados en un google drive en formato csv
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">code</div>
                <div class="quarto-category">analysis</div>
                <div class="quarto-category">visualization</div>
                <div class="quarto-category">pro-choice</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>David Humberto Jiménez S. </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">April 18, 2018</p>
      </div>
    </div>
    
      <div>
      <div class="quarto-title-meta-heading">Modified</div>
      <div class="quarto-title-meta-contents">
        <p class="date-modified">November 22, 2023</p>
      </div>
    </div>
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<p>Este post es una actualización y revisión de un post de la primera iteración de este blog.</p>
<section id="datos-sobre-ile-en-la-ciudad-de-méxico" class="level2">
<h2 class="anchored" data-anchor-id="datos-sobre-ile-en-la-ciudad-de-méxico">Datos sobre ILE en la Ciudad de México</h2>
<p>El 24 de abril, es decir, el viernes de la semana pasada, en la Ciudad de México se cumplieron 13 años de la despenalización de la Interrupción Legal del Embarazo. Adicionalmente, desde el año pasado la ADIP ha abierto los datos respecto a las interrupciones en la Ciudad de México en clínicas y hospitales de la Secretaría de la Salud de la Ciudad de México.</p>
<p>Por eso, vamos a revisar la base de datos actualizada disponible en el sitio de la <a href="https://datos.cdmx.gob.mx/explore/dataset/interrupcion-legal-del-embarazo/table/">ADIP</a>. Para hacer esto, vamos a combinar los datos que están segmentados por periodos: - 2016 a 2018 - 2019 a 2021 - 1er semestre 2022</p>
<p>Por razones de facilidad y replicabilidad, descargué los datos y los subí a una carpeta de google drive</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>origen_16 <span class="ot">&lt;-</span> <span class="st">"https://docs.google.com/spreadsheets/d/e/2PACX-1vQ_HoUvYXipMvAB0DkLcMbTNWWVYx-9k4CQomTXmT04yVOrqunILg5CnEWDVRaDniJavSalb0bwOX4e/pub?output=csv"</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>d16 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(origen_16, <span class="at">stringsAsFactors =</span> F, <span class="at">fileEncoding =</span> <span class="st">"UTF-8"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate_all</span>(as.character)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>origen_19 <span class="ot">&lt;-</span> <span class="st">"https://docs.google.com/spreadsheets/d/e/2PACX-1vTKDzF5efQP58F0JhV6iaQavOTIEc4yRJcPIrr3Hj_fOdlPj34bBVWEkHhjEbi0dN7QU0VxbOabrjOE/pub?output=csv"</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>d19 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(origen_19, <span class="at">stringsAsFactors =</span> F, <span class="at">fileEncoding =</span> <span class="st">"UTF-8"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate_all</span>(as.character)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>origen_22 <span class="ot">&lt;-</span> <span class="st">"https://docs.google.com/spreadsheets/d/e/2PACX-1vSioEYHSp8R0bXmDA8N3KTRcFCjwodY34gnR9-vBq56b6ATUWyTbuUsik3tLniRHzFTGmd69NTubWS_/pub?output=csv"</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>d22 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(origen_16, <span class="at">stringsAsFactors =</span> F, <span class="at">fileEncoding =</span> <span class="st">"UTF-8"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate_all</span>(as.character)</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(d16, d19, d22)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>En el <em>chunk</em> anterior, los objetos llamados <strong>origen</strong> son los enlaces a las bases de datos. La función <strong>read.csv</strong> tiene varios argumentos (como todas las funciones para leer bases de datos): - <strong>file</strong> es el primero y más importante, y es desde donde se va a leer la base de datos. Puede escribirse directamente. - <strong>stringsAsFactors</strong> es para que las variables que son texto no se conviertan en factores (un factor es una variable de categorías mutuamente excluyentes). - <strong>fileEncoding</strong> es para leer bien los acentos y carácteres especiales. UTF-8 y Windows 1252 son los más comunes.</p>
<p>Adicionalmente, porque en un archivo la variable “fecha de primera menstruación” está almacenado como texto mientras que en otro como numérico, no se pueden combinar sin transformar alguno de los <em>data frames</em>. Por eso utilizó la función <strong>mutate_all</strong> que modifica <strong>todas</strong> las variables, en este caso para convertirlas en texto (<em>strings</em>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DT)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'DT' was built under R version 4.2.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(<span class="fu">head</span>(datos), <span class="at">rownames =</span> F, <span class="at">class =</span> <span class="st">"display"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-0a80ea38801066ed83d2" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-0a80ea38801066ed83d2">{"x":{"filter":"none","vertical":false,"data":[["2016","2016","2016","2016","2016","2016"],["Abril","Abril","Abril","Abril","Abril","Abril"],["2016-04-01","2016-04-01","2016-04-01","2016-04-01","2016-04-01","2016-04-01"],[null,null,null,null,null,null],["Soltera","Soltera","Casada","Soltera","Soltera","Soltera"],["24","30","38","23","18","18"],["Ninguno","Ninguno","Ninguno","Ninguno","Ninguno","Ninguno"],["Preparatoria","Secundaria","Sin acceso a la educacion formal","Preparatoria","Secundaria","Secundaria"],["Estudiante","Trabajadora del hogar no remunerada","Trabajadora del hogar no remunerada","Empleada","Estudiante","Empleada"],["Ninguna","Católica","Católica","Ninguna","Ninguna","Ninguna"],[null,null,null,null,null,null],["Ciudad de México","Estado de México","Estado de México","Estado de México","Estado de México","Estado de México"],["Azcapotzalco","Fuera de CDMX","Fuera de CDMX",null,null,null],["CDMX","Ecatepec de Morelos","Ecatepec de Morelos",null,null,null],["12","12","13","10","13","14"],["13","17","15","15","15","16"],["27/01/2016","08/01/2016","15/02/2016","20/02/2016","18/02/2016","01/02/2016"],["1","3","7","2","1","2"],["8","9","4","4","4","7"],["0","0","0","0","0","0"],["0","1","5","0","0","1"],["0","0","0","0","0","0"],["0","1","1","1","0","0"],[null,null,null,null,null,null],["Si","Si","Si","Si","Si","Si"],["Ninguno","Ninguno","Ninguno","Ninguno","Ninguno","Ninguno"],["01/04/2016","01/04/2016","01/04/2016","01/04/2016","01/04/2016","01/04/2016"],["1","1","1","1","1","1"],["Interrupción voluntaria","Interrupción voluntaria","Interrupción voluntaria","Interrupción voluntaria","Interrupción voluntaria","Interrupción voluntaria"],[null,null,null,null,null,null],[null,null,null,null,null,null],[null,null,null,null,null,null],["3","6","2","1","0","5"],[null,null,null,null,null,null],[null,null,null,null,null,null],[null,null,null,null,null,null],[null,null,null,null,null,null],[null,null,null,null,null,null],["Condón","Condón","Condón","Condón","Ninguno","Condón"],["08/04/2016","08/04/2016","08/04/2016","08/04/2016","15/04/2016","08/04/2016"],["Completa","Completa","Completa","Completa","Otro","Completa"],["Medicamento","Medicamento","Medicamento","Medicamento","Medicamento","Medicamento"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>anio<\/th>\n      <th>mes<\/th>\n      <th>fecha_ingreso<\/th>\n      <th>referida<\/th>\n      <th>estado_civil<\/th>\n      <th>edad<\/th>\n      <th>institucion_derechohab<\/th>\n      <th>nivel_edu<\/th>\n      <th>ocupacion<\/th>\n      <th>religion<\/th>\n      <th>parentesco<\/th>\n      <th>entidad<\/th>\n      <th>alcaldia<\/th>\n      <th>municipio<\/th>\n      <th>edad_primera_menstruacion<\/th>\n      <th>edad_inicio_vida_sexual<\/th>\n      <th>fecha_ultima_menstruacion<\/th>\n      <th>semanas_embarazo<\/th>\n      <th>numero_hijos<\/th>\n      <th>numero_embarazos<\/th>\n      <th>numero_abortos<\/th>\n      <th>numero_partos<\/th>\n      <th>numero_cesareas<\/th>\n      <th>numero_iles<\/th>\n      <th>recibio_consejeria<\/th>\n      <th>uso_anticonceptivo<\/th>\n      <th>fecha_primera_valoracion<\/th>\n      <th>numero_consultas<\/th>\n      <th>motivos_interrupcion<\/th>\n      <th>fecha_ingreso_hosp<\/th>\n      <th>fecha_egreso_hosp<\/th>\n      <th>desc_servicio<\/th>\n      <th>semanas_gestacion_usg<\/th>\n      <th>dias_gestacion_usg<\/th>\n      <th>firma_consentimiento<\/th>\n      <th>se_complica<\/th>\n      <th>con_dolor<\/th>\n      <th>analgesico<\/th>\n      <th>anticonceptivo_post<\/th>\n      <th>fecha_cierre<\/th>\n      <th>resultado_ile<\/th>\n      <th>procedimiento_ile<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Si quieren saber que significan las variables, pueden descargar el <a href="https://datos.cdmx.gob.mx/dataset/3688e08c-029f-4b47-bb69-f2bc0ecf8bd1/resource/9d74bab2-8a5f-40f3-b991-ab27cc3d6412/download/diccionario-de-datos-ile.csv">diccionario de datos</a>. Un Diccionario de datos es el estándar para explicar los nombres de las variables.</p>
<p>Ahora, los paquetes. Usualmente, los paquetes van al principio del código y van juntos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'janitor' was built under R version 4.2.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'janitor'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    chisq.test, fisher.test</code></pre>
</div>
</div>
<p>Vamos a hacer tablas con el conteo por las variables. Como es un ejemplo, trataré de hacer cosas basicas. Esto se hace con el paquete <a href="https://garthtarr.github.io/meatR/janitor.html">janitor</a>. Además de hacer tablas, el paquete <strong>Janitor</strong> “limpia” las bases de datos. En este caso, vamos a cambiar los nombres de las variables: la variable Año suele tener</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> <span class="fu">clean_names</span>(datos)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(datos)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "anio"                      "mes"                      
 [3] "fecha_ingreso"             "referida"                 
 [5] "estado_civil"              "edad"                     
 [7] "institucion_derechohab"    "nivel_edu"                
 [9] "ocupacion"                 "religion"                 
[11] "parentesco"                "entidad"                  
[13] "alcaldia"                  "municipio"                
[15] "edad_primera_menstruacion" "edad_inicio_vida_sexual"  
[17] "fecha_ultima_menstruacion" "semanas_embarazo"         
[19] "numero_hijos"              "numero_embarazos"         
[21] "numero_abortos"            "numero_partos"            
[23] "numero_cesareas"           "numero_iles"              
[25] "recibio_consejeria"        "uso_anticonceptivo"       
[27] "fecha_primera_valoracion"  "numero_consultas"         
[29] "motivos_interrupcion"      "fecha_ingreso_hosp"       
[31] "fecha_egreso_hosp"         "desc_servicio"            
[33] "semanas_gestacion_usg"     "dias_gestacion_usg"       
[35] "firma_consentimiento"      "se_complica"              
[37] "con_dolor"                 "analgesico"               
[39] "anticonceptivo_post"       "fecha_cierre"             
[41] "resultado_ile"             "procedimiento_ile"        </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tabyl</span>(datos, anio)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> anio     n      percent
 2015     2 1.414467e-05
 2016 36076 2.551416e-01
 2017 35194 2.489038e-01
 2018 31436 2.223259e-01
 2019 15129 1.069974e-01
 2020 11267 7.968401e-02
 2021 12292 8.693315e-02</code></pre>
</div>
</div>
<p>Esta primera tabla muestra el número de procedimientos por año y el porcentaje del total. La función <em>tabyl</em> proviene del paquete <strong>janitor</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tabyl</span>(datos, anio, mes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> anio Abril Agosto Diciembre Enero Febrero Julio Junio Marzo Mayo Noviembre
 2015     0      0         0     0       0     0     0     0    0         2
 2016  3316   3132      2302  2782    2938  3048  3316  2900 3048      3112
 2017  2384   3186      2542  3518    2928  2790  2980  3352 3112      2722
 2018  2852   2648      1788  3284    2852  2366  2614  3038 2894      1948
 2019  1219   1334       941  1419    1271  1210  1218  1285 1480      1232
 2020   883    786       803  1462    1373   782   663  1358  636       814
 2021  1066   1158      1010   785     797  1021  1154  1063  960      1124
 Octubre Septiembre
       0          0
    3156       3026
    3248       2432
    2656       2496
    1330       1190
     888        819
    1157        997</code></pre>
</div>
</div>
<p>En este caso, la tabla no sale tan pulcra. Por esa razón vamos a hacerla con dplyr.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>tabla <span class="ot">&lt;-</span> datos <span class="sc">%&gt;%</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">cont =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(anio, mes) <span class="sc">%&gt;%</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">total =</span> <span class="fu">sum</span>(cont))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'anio'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(tabla, <span class="at">rownames =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-9f6bb8739cabc30ed908" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-9f6bb8739cabc30ed908">{"x":{"filter":"none","vertical":false,"data":[["2015","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2016","2017","2017","2017","2017","2017","2017","2017","2017","2017","2017","2017","2017","2018","2018","2018","2018","2018","2018","2018","2018","2018","2018","2018","2018","2019","2019","2019","2019","2019","2019","2019","2019","2019","2019","2019","2019","2020","2020","2020","2020","2020","2020","2020","2020","2020","2020","2020","2020","2021","2021","2021","2021","2021","2021","2021","2021","2021","2021","2021","2021"],["Noviembre","Abril","Agosto","Diciembre","Enero","Febrero","Julio","Junio","Marzo","Mayo","Noviembre","Octubre","Septiembre","Abril","Agosto","Diciembre","Enero","Febrero","Julio","Junio","Marzo","Mayo","Noviembre","Octubre","Septiembre","Abril","Agosto","Diciembre","Enero","Febrero","Julio","Junio","Marzo","Mayo","Noviembre","Octubre","Septiembre","Abril","Agosto","Diciembre","Enero","Febrero","Julio","Junio","Marzo","Mayo","Noviembre","Octubre","Septiembre","Abril","Agosto","Diciembre","Enero","Febrero","Julio","Junio","Marzo","Mayo","Noviembre","Octubre","Septiembre","Abril","Agosto","Diciembre","Enero","Febrero","Julio","Junio","Marzo","Mayo","Noviembre","Octubre","Septiembre"],[2,3316,3132,2302,2782,2938,3048,3316,2900,3048,3112,3156,3026,2384,3186,2542,3518,2928,2790,2980,3352,3112,2722,3248,2432,2852,2648,1788,3284,2852,2366,2614,3038,2894,1948,2656,2496,1219,1334,941,1419,1271,1210,1218,1285,1480,1232,1330,1190,883,786,803,1462,1373,782,663,1358,636,814,888,819,1066,1158,1010,785,797,1021,1154,1063,960,1124,1157,997]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>anio<\/th>\n      <th>mes<\/th>\n      <th>total<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":2}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Esta tabla se hizo con <strong>dplyr</strong>. Este paquete nos permite manipular bases de datos de manera sencilla. Hay que pensar el procesamiento como pasos secuenciales. Es igual que la rutina de la mañana: te despiertas, revisas el teléfono, vas al baño, desayunas, etc.</p>
<p>En este caso, a la base “datos” le aplicaremos distintas operaciones gracias al operador pipe (<strong>%&gt;%</strong>). Es decir a la base de datos le haremos un mutate(crear una nueva variable) luego ( %&gt;% ) agrupamos las variables año y mes; para finalizar ( %&gt;% ) le hacemos un summarise (colpasamos la base de datos) en ese caso sumaremos la variable cont (que es ponerle un 1 a cada renglón) por año y mes.</p>
<p>Como ya habrán notado, los meses están desordenados.</p>
</section>
<section id="gráficas" class="level2">
<h2 class="anchored" data-anchor-id="gráficas">Gráficas</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>graf <span class="ot">&lt;-</span> datos <span class="sc">%&gt;%</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">cont =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(anio, mes) <span class="sc">%&gt;%</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">total =</span> <span class="fu">sum</span>(cont)) <span class="sc">%&gt;%</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(anio) <span class="sc">%&gt;%</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">tot =</span> <span class="fu">sum</span>(total),</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">porc =</span> total <span class="sc">/</span> tot</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">mes =</span> <span class="fu">factor</span>(mes,</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">levels =</span> <span class="fu">c</span>(</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Enero"</span>, <span class="st">"Febrero"</span>, <span class="st">"Marzo"</span>, <span class="st">"Abril"</span>, <span class="st">"Mayo"</span>, <span class="st">"Junio"</span>,</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Julio"</span>, <span class="st">"Agosto"</span>, <span class="st">"Septiembre"</span>, <span class="st">"Octubre"</span>, <span class="st">"Noviembre"</span>, <span class="st">"Diciembre"</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">anio =</span> <span class="fu">factor</span>(anio,</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>            <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">2016</span><span class="sc">:</span><span class="dv">2022</span>)</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'anio'. You can override using the
`.groups` argument.</code></pre>
</div>
</div>
<p>Este código calcula el porcentaje por mes y año. Además, ordena los meses y el año como factores.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(graf, <span class="fu">aes</span>(<span class="at">x =</span> mes, <span class="at">y =</span> porc, <span class="at">group =</span> anio)) <span class="sc">+</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> anio)) <span class="sc">+</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent_format</span>(),</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.15</span>)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 1 row containing missing values (`geom_line()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Esta gráfica muestra el porcentaje por mes y por año. En esta gráfica utilizo lineas para mostrar la distribución de interrupciones por mes para los años disponibles. Esto a través del <strong>geom_line</strong> en donde cada año tiene un color distinto.</p>
<p>Además, en <strong>scale_y_continous</strong> defino do parametros: <em>labels</em>, que es como se presentan los números, en este caso como porcentaje; y <em>limits</em> muestra que parte de la gráfica se debe visualizar. En este caso escogi entre el 5% y el 15% para ver los detalles. Mientras que en el caso de <em>scales::</em>, esta es una forma de utilizar una función de un paquete sin tener que poner <strong>library</strong>. ¿Qué por qué necesitamos esto? A veces cargar un paquete es demasiado para nuestra computadora, piensa que un paquete es como un foco, no prendes un foco de un cuarto en el que no estás.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>graf2 <span class="ot">&lt;-</span> datos <span class="sc">%&gt;%</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">cont =</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(anio <span class="sc">&gt;</span> <span class="dv">2015</span> <span class="sc">&amp;</span> anio <span class="sc">&lt;</span> <span class="dv">2022</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(anio, mes) <span class="sc">%&gt;%</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">total =</span> <span class="fu">sum</span>(cont)) <span class="sc">%&gt;%</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(anio) <span class="sc">%&gt;%</span></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">tot =</span> <span class="fu">sum</span>(total),</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">porc =</span> total <span class="sc">/</span> tot</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">mes =</span> <span class="fu">factor</span>(mes,</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>            <span class="at">levels =</span> <span class="fu">c</span>(</span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Enero"</span>, <span class="st">"Febrero"</span>, <span class="st">"Marzo"</span>, <span class="st">"Abril"</span>, <span class="st">"Mayo"</span>, <span class="st">"Junio"</span>,</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Julio"</span>, <span class="st">"Agosto"</span>, <span class="st">"Septiembre"</span>, <span class="st">"Octubre"</span>, <span class="st">"Noviembre"</span>, <span class="st">"Diciembre"</span></span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>        ),</span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>        <span class="at">anio =</span> <span class="fu">factor</span>(anio,</span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>            <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">2016</span><span class="sc">:</span><span class="dv">2021</span>)</span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'anio'. You can override using the
`.groups` argument.</code></pre>
</div>
</div>
<p>Quitamos el año en cuestión y volvemos a graficar.En este caso, no filtramos utilizando el mismo objeto debido a que un factor no se puede filtrar.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(graf2, <span class="fu">aes</span>(<span class="at">x =</span> mes, <span class="at">y =</span> porc, <span class="at">group =</span> anio)) <span class="sc">+</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">color =</span> anio)) <span class="sc">+</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> anio)) <span class="sc">+</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.15</span>),</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">labels =</span> scales<span class="sc">::</span><span class="fu">percent_format</span>()</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"Porcentaje de procedimientos mensuales en la CDMX"</span>,</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">subtitle =</span> <span class="st">"2016 al 2021"</span>,</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">""</span>,</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">color =</span> <span class="st">"Año"</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="fl">0.9</span>),</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">legend.position =</span> <span class="st">"bottom"</span></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>En este caso, agregamos nuevos argumentos en <strong>theme</strong>. <em>axis.text.x</em> es para modificar como vemos las eetiquetas del eje de las x (el eje horizontal). En este caso, lo giré 45° y lo ajusté para que no se sobreponga.</p>
<p>Aunque son cosas sencillas, pueden ser interesantes para pensar y presentar puntos. Y aprovechando que tenemos una base con tantas variables, podemos jugar con los datos y ver que otras cosas aparecen. Por ejemplo:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(datos, <span class="fu">aes</span>(<span class="at">x =</span> estado_civil, <span class="at">y =</span> <span class="fu">as.numeric</span>(edad))) <span class="sc">+</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"Diagrama de caja y brazos por estado civil"</span>,</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"Edad"</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">10</span>, <span class="dv">60</span>, <span class="at">by =</span> <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_flip</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Un diagrama de caja y brazos (<em>boxplot</em>) nos muestra de manera gráfica los cuartiles de una variable. Es decir, los extremos de la caja representan el primer y tercer cuartil. Y la barra dentro de la caja representa el promedio. Mientras que los puntos representan <em>outliers</em> o valores atípicos.</p>
<p>Como ya vimos cambiar la escala del eje es fácil, pero también podemos agregarle más detalle para interpretarla mejor: <em>breaks</em> permite modificar la escala, en este caso utilicé una secuencia (<strong>seq</strong>) del 10 al 60 de 2 en 2.</p>
<p>Por esta razón, esta gráfica muestra la distribución por edad de acuerdo al estado civil reportado para el procedimiento. Algo que salta a la vista es el hecho de que la mujer más joven sometida a un procedimiento es de 12 años.</p>
<p>Por último, vamos a hacer esta misma gráfica, pero la separaremos por años.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(datos, <span class="fu">aes</span>(<span class="at">x =</span> estado_civil, <span class="at">y =</span> <span class="fu">as.numeric</span>(edad))) <span class="sc">+</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"Diagrama de caja y brazos por estado civil"</span>,</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"Edad"</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">10</span>, <span class="dv">60</span>, <span class="at">by =</span> <span class="dv">2</span>)) <span class="sc">+</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(anio <span class="sc">~</span> .)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>La función <strong>facet_grid</strong> puede ser utilizado de manera fija (vertical u horizontal) o ajustarlo dentro de un rectángulo con <em>facet_wrap</em>. Los argumentos son los mismos en ambos casos: (variable1 ~ variable2). Con esto quiero decir que puede separar las gráficas por otras variables. En este caso, vemos los diagramas de caja y brazos por año. Pero así se ve muy feo, probemos otra configuración de los <em>facet</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(datos, <span class="fu">aes</span>(<span class="at">x =</span> estado_civil, <span class="at">y =</span> <span class="fu">as.numeric</span>(edad))) <span class="sc">+</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"Diagrama de caja y brazos por estado civil"</span>,</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"Edad"</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">10</span>, <span class="dv">60</span>, <span class="at">by =</span> <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>)) <span class="sc">+</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_grid</span>(<span class="at">cols =</span> <span class="fu">vars</span>(<span class="fu">as.numeric</span>(anio)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Aquí le especificamos a <strong>R</strong> que ponga un número de columnas igual al de nuestra variable de interés (como no la podemos “pasar” directamente utilizamos <em>vars</em> de dplyr).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(datos, <span class="fu">aes</span>(<span class="at">x =</span> nivel_edu, <span class="at">y =</span> <span class="fu">as.numeric</span>(numero_hijos))) <span class="sc">+</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">title =</span> <span class="st">"Distribución de hijes por nivel educativo"</span>,</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> <span class="st">"Número de hijes"</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_flip</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 18398 rows containing non-finite values (`stat_boxplot()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>De manera similar, podemos observar el número de hijes por nivel educativo de las pacientes. Hay muchísimos valores atípicos.</p>
</section>
<section id="función-summary-correlación-y-diagramas-de-dispersión" class="level2">
<h2 class="anchored" data-anchor-id="función-summary-correlación-y-diagramas-de-dispersión">Función summary, correlación y diagramas de dispersión</h2>
<p>Asimismo, algo que no he mencionada claramente es que después de usar la función <strong>mutate_all</strong> todas las variables se modificaron, para convertirse en <em>strings</em> (o texto) y esto no siempre es útil al momento de gráficar. Por eso, si observaron, utilicé la función <strong>as_numeric</strong> dentro de las gráficas: para especificar que se trataba de una variable numérica.</p>
<p>Para hacer más análisis, es conveniente conocer las distribuciones de las variables y su relación entre ellas. Por lo que convertiremos aquellas variables numéricas y exploraremos el contenido de ese conjunto de datos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(datos)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  anio   mes fecha_ingreso referida estado_civil edad institucion_derechohab
1 2016 Abril    2016-04-01     &lt;NA&gt;      Soltera   24                Ninguno
2 2016 Abril    2016-04-01     &lt;NA&gt;      Soltera   30                Ninguno
3 2016 Abril    2016-04-01     &lt;NA&gt;       Casada   38                Ninguno
4 2016 Abril    2016-04-01     &lt;NA&gt;      Soltera   23                Ninguno
5 2016 Abril    2016-04-01     &lt;NA&gt;      Soltera   18                Ninguno
6 2016 Abril    2016-04-01     &lt;NA&gt;      Soltera   18                Ninguno
                         nivel_edu                           ocupacion religion
1                     Preparatoria                          Estudiante  Ninguna
2                       Secundaria Trabajadora del hogar no remunerada Católica
3 Sin acceso a la educacion formal Trabajadora del hogar no remunerada Católica
4                     Preparatoria                            Empleada  Ninguna
5                       Secundaria                          Estudiante  Ninguna
6                       Secundaria                            Empleada  Ninguna
  parentesco          entidad      alcaldia           municipio
1       &lt;NA&gt; Ciudad de México  Azcapotzalco                CDMX
2       &lt;NA&gt; Estado de México Fuera de CDMX Ecatepec de Morelos
3       &lt;NA&gt; Estado de México Fuera de CDMX Ecatepec de Morelos
4       &lt;NA&gt; Estado de México          &lt;NA&gt;                &lt;NA&gt;
5       &lt;NA&gt; Estado de México          &lt;NA&gt;                &lt;NA&gt;
6       &lt;NA&gt; Estado de México          &lt;NA&gt;                &lt;NA&gt;
  edad_primera_menstruacion edad_inicio_vida_sexual fecha_ultima_menstruacion
1                        12                      13                27/01/2016
2                        12                      17                08/01/2016
3                        13                      15                15/02/2016
4                        10                      15                20/02/2016
5                        13                      15                18/02/2016
6                        14                      16                01/02/2016
  semanas_embarazo numero_hijos numero_embarazos numero_abortos numero_partos
1                1            8                0              0             0
2                3            9                0              1             0
3                7            4                0              5             0
4                2            4                0              0             0
5                1            4                0              0             0
6                2            7                0              1             0
  numero_cesareas numero_iles recibio_consejeria uso_anticonceptivo
1               0        &lt;NA&gt;                 Si            Ninguno
2               1        &lt;NA&gt;                 Si            Ninguno
3               1        &lt;NA&gt;                 Si            Ninguno
4               1        &lt;NA&gt;                 Si            Ninguno
5               0        &lt;NA&gt;                 Si            Ninguno
6               0        &lt;NA&gt;                 Si            Ninguno
  fecha_primera_valoracion numero_consultas    motivos_interrupcion
1               01/04/2016                1 Interrupción voluntaria
2               01/04/2016                1 Interrupción voluntaria
3               01/04/2016                1 Interrupción voluntaria
4               01/04/2016                1 Interrupción voluntaria
5               01/04/2016                1 Interrupción voluntaria
6               01/04/2016                1 Interrupción voluntaria
  fecha_ingreso_hosp fecha_egreso_hosp desc_servicio semanas_gestacion_usg
1               &lt;NA&gt;              &lt;NA&gt;          &lt;NA&gt;                     3
2               &lt;NA&gt;              &lt;NA&gt;          &lt;NA&gt;                     6
3               &lt;NA&gt;              &lt;NA&gt;          &lt;NA&gt;                     2
4               &lt;NA&gt;              &lt;NA&gt;          &lt;NA&gt;                     1
5               &lt;NA&gt;              &lt;NA&gt;          &lt;NA&gt;                     0
6               &lt;NA&gt;              &lt;NA&gt;          &lt;NA&gt;                     5
  dias_gestacion_usg firma_consentimiento se_complica con_dolor analgesico
1               &lt;NA&gt;                 &lt;NA&gt;        &lt;NA&gt;      &lt;NA&gt;       &lt;NA&gt;
2               &lt;NA&gt;                 &lt;NA&gt;        &lt;NA&gt;      &lt;NA&gt;       &lt;NA&gt;
3               &lt;NA&gt;                 &lt;NA&gt;        &lt;NA&gt;      &lt;NA&gt;       &lt;NA&gt;
4               &lt;NA&gt;                 &lt;NA&gt;        &lt;NA&gt;      &lt;NA&gt;       &lt;NA&gt;
5               &lt;NA&gt;                 &lt;NA&gt;        &lt;NA&gt;      &lt;NA&gt;       &lt;NA&gt;
6               &lt;NA&gt;                 &lt;NA&gt;        &lt;NA&gt;      &lt;NA&gt;       &lt;NA&gt;
  anticonceptivo_post fecha_cierre resultado_ile procedimiento_ile
1              Condón   08/04/2016      Completa       Medicamento
2              Condón   08/04/2016      Completa       Medicamento
3              Condón   08/04/2016      Completa       Medicamento
4              Condón   08/04/2016      Completa       Medicamento
5             Ninguno   15/04/2016          Otro       Medicamento
6              Condón   08/04/2016      Completa       Medicamento</code></pre>
</div>
</div>
<p>Cuando no conocemos el contenido de los datos siempre es útil ver los primeros renglones de un conjunto, y exactamente eso es lo que hace la función <strong>head</strong>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> datos <span class="sc">%&gt;%</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">fecha_ingreso =</span> lubridate<span class="sc">::</span><span class="fu">ymd</span>(fecha_ingreso),</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">edad =</span> <span class="fu">as.numeric</span>(edad),</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">edad_primera_menstruacion =</span> <span class="fu">as.numeric</span>(edad_primera_menstruacion),</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">edad_inicio_vida_sexual =</span> <span class="fu">as.numeric</span>(edad_inicio_vida_sexual),</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">fecha_ultima_menstruacion =</span> lubridate<span class="sc">::</span><span class="fu">dym</span>(fecha_ultima_menstruacion),</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">semanas_embarazo =</span> <span class="fu">as.numeric</span>(semanas_embarazo),</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">numero_hijos =</span> <span class="fu">as.numeric</span>(numero_hijos),</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">numero_embarazos =</span> <span class="fu">as.numeric</span>(numero_embarazos),</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">numero_abortos =</span> <span class="fu">as.numeric</span>(numero_abortos),</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">numero_partos =</span> <span class="fu">as.numeric</span>(numero_partos),</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>        <span class="at">fecha_primera_valoracion =</span> lubridate<span class="sc">::</span><span class="fu">dmy</span>(fecha_primera_valoracion),</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">numero_consultas =</span> <span class="fu">as.numeric</span>(numero_consultas),</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>        <span class="at">semanas_gestacion_usg =</span> <span class="fu">as.numeric</span>(semanas_gestacion_usg),</span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: There were 3 warnings in `mutate()`.
The first warning was:
ℹ In argument: `edad_primera_menstruacion =
  as.numeric(edad_primera_menstruacion)`.
Caused by warning:
! NAs introduced by coercion
ℹ Run `dplyr::last_dplyr_warnings()` to see the 2 remaining warnings.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(datos)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     anio               mes            fecha_ingreso          referida        
 Length:141396      Length:141396      Min.   :2016-01-04   Length:141396     
 Class :character   Class :character   1st Qu.:2016-12-16   Class :character  
 Mode  :character   Mode  :character   Median :2017-12-20   Mode  :character  
                                       Mean   :2018-03-31                     
                                       3rd Qu.:2019-03-14                     
                                       Max.   :2021-12-31                     
                                                                              
 estado_civil            edad       institucion_derechohab  nivel_edu        
 Length:141396      Min.   :11.00   Length:141396          Length:141396     
 Class :character   1st Qu.:21.00   Class :character       Class :character  
 Mode  :character   Median :25.00   Mode  :character       Mode  :character  
                    Mean   :25.77                                            
                    3rd Qu.:30.00                                            
                    Max.   :56.00                                            
                                                                             
  ocupacion           religion          parentesco          entidad         
 Length:141396      Length:141396      Length:141396      Length:141396     
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
                                                                            
                                                                            
                                                                            
                                                                            
   alcaldia          municipio         edad_primera_menstruacion
 Length:141396      Length:141396      Min.   :   0.00          
 Class :character   Class :character   1st Qu.:  12.00          
 Mode  :character   Mode  :character   Median :  12.00          
                                       Mean   :  12.66          
                                       3rd Qu.:  14.00          
                                       Max.   :1218.00          
                                       NA's   :7263             
 edad_inicio_vida_sexual fecha_ultima_menstruacion semanas_embarazo
 Min.   : -1.00          Min.   :NA                Min.   : 0.000  
 1st Qu.: 15.00          1st Qu.:NA                1st Qu.: 6.000  
 Median : 17.00          Median :NA                Median : 7.000  
 Mean   : 16.96          Mean   :NaN               Mean   : 7.366  
 3rd Qu.: 18.00          3rd Qu.:NA                3rd Qu.: 9.000  
 Max.   :128.00          Max.   :NA                Max.   :39.000  
 NA's   :7065            NA's   :141396            NA's   :9182    
  numero_hijos   numero_embarazos numero_abortos   numero_partos   
 Min.   : 0.00   Min.   : 0.000   Min.   : 0.000   Min.   : 0.000  
 1st Qu.: 0.00   1st Qu.: 1.000   1st Qu.: 0.000   1st Qu.: 0.000  
 Median : 1.00   Median : 2.000   Median : 0.000   Median : 0.000  
 Mean   : 1.03   Mean   : 2.341   Mean   : 0.175   Mean   : 0.699  
 3rd Qu.: 2.00   3rd Qu.: 3.000   3rd Qu.: 0.000   3rd Qu.: 1.000  
 Max.   :10.00   Max.   :47.000   Max.   :10.000   Max.   :12.000  
 NA's   :18398   NA's   :5500     NA's   :7909     NA's   :7355    
 numero_cesareas    numero_iles        recibio_consejeria uso_anticonceptivo
 Length:141396      Length:141396      Length:141396      Length:141396     
 Class :character   Class :character   Class :character   Class :character  
 Mode  :character   Mode  :character   Mode  :character   Mode  :character  
                                                                            
                                                                            
                                                                            
                                                                            
 fecha_primera_valoracion numero_consultas motivos_interrupcion
 Min.   :2015-01-13       Min.   :0.00     Length:141396       
 1st Qu.:2016-08-17       1st Qu.:1.00     Class :character    
 Median :2017-04-27       Median :2.00     Mode  :character    
 Mean   :2017-05-08       Mean   :1.63                         
 3rd Qu.:2018-01-22       3rd Qu.:2.00                         
 Max.   :2022-06-30       Max.   :7.00                         
 NA's   :72122            NA's   :55083                        
 fecha_ingreso_hosp fecha_egreso_hosp  desc_servicio      semanas_gestacion_usg
 Length:141396      Length:141396      Length:141396      Min.   : 0.000       
 Class :character   Class :character   Class :character   1st Qu.: 5.000       
 Mode  :character   Mode  :character   Mode  :character   Median : 7.000       
                                                          Mean   : 6.849       
                                                          3rd Qu.: 8.000       
                                                          Max.   :13.000       
                                                          NA's   :58           
 dias_gestacion_usg firma_consentimiento se_complica         con_dolor        
 Length:141396      Length:141396        Length:141396      Length:141396     
 Class :character   Class :character     Class :character   Class :character  
 Mode  :character   Mode  :character     Mode  :character   Mode  :character  
                                                                              
                                                                              
                                                                              
                                                                              
  analgesico        anticonceptivo_post fecha_cierre       resultado_ile     
 Length:141396      Length:141396       Length:141396      Length:141396     
 Class :character   Class :character    Class :character   Class :character  
 Mode  :character   Mode  :character    Mode  :character   Mode  :character  
                                                                             
                                                                             
                                                                             
                                                                             
 procedimiento_ile 
 Length:141396     
 Class :character  
 Mode  :character  
                   
                   
                   
                   </code></pre>
</div>
</div>
<p>La función <strong>summary</strong> muestra las medidas de dispersión de las variables numéricas. Estas son: mínimo, primer cuartil, mediana, promedio (media), tercer cuartil y máximo. Para ampliar el análisis y tener mayor precisión, calcularemos la matriz de correlación de las variables numéricas.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>data_corr <span class="ot">&lt;-</span> datos <span class="sc">%&gt;%</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select_if</span>(is.numeric) <span class="sc">%&gt;%</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cor</span>(<span class="at">use =</span> <span class="st">"complete.obs"</span>)</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>data_corr</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                  edad edad_primera_menstruacion
edad                       1.000000000               0.057586227
edad_primera_menstruacion  0.057586227               1.000000000
edad_inicio_vida_sexual    0.297156958               0.165297888
semanas_embarazo          -0.047583584               0.002419982
numero_hijos               0.529754901               0.018214861
numero_embarazos           0.509453410               0.015384603
numero_abortos             0.184712016              -0.005272162
numero_partos              0.438648925               0.014829545
numero_consultas           0.007061204              -0.013576089
semanas_gestacion_usg     -0.051257514               0.009819498
                          edad_inicio_vida_sexual semanas_embarazo numero_hijos
edad                                  0.297156958     -0.047583584  0.529754901
edad_primera_menstruacion             0.165297888      0.002419982  0.018214861
edad_inicio_vida_sexual               1.000000000     -0.035772751 -0.089176568
semanas_embarazo                     -0.035772751      1.000000000  0.007242731
numero_hijos                         -0.089176568      0.007242731  1.000000000
numero_embarazos                     -0.086979103      0.002583078  0.777413606
numero_abortos                       -0.025962601     -0.016181134  0.133229390
numero_partos                        -0.097278151      0.025068613  0.811973489
numero_consultas                      0.005425544     -0.011453455 -0.011822880
semanas_gestacion_usg                -0.038712091      0.543637998  0.024342230
                          numero_embarazos numero_abortos numero_partos
edad                          0.5094534098    0.184712016   0.438648925
edad_primera_menstruacion     0.0153846034   -0.005272162   0.014829545
edad_inicio_vida_sexual      -0.0869791025   -0.025962601  -0.097278151
semanas_embarazo              0.0025830776   -0.016181134   0.025068613
numero_hijos                  0.7774136061    0.133229390   0.811973489
numero_embarazos              1.0000000000    0.359192997   0.689282273
numero_abortos                0.3591929968    1.000000000   0.082375706
numero_partos                 0.6892822729    0.082375706   1.000000000
numero_consultas              0.0007671129   -0.004946456  -0.005796846
semanas_gestacion_usg         0.0033645966   -0.013170875   0.040325056
                          numero_consultas semanas_gestacion_usg
edad                          0.0070612036          -0.051257514
edad_primera_menstruacion    -0.0135760890           0.009819498
edad_inicio_vida_sexual       0.0054255435          -0.038712091
semanas_embarazo             -0.0114534551           0.543637998
numero_hijos                 -0.0118228801           0.024342230
numero_embarazos              0.0007671129           0.003364597
numero_abortos               -0.0049464559          -0.013170875
numero_partos                -0.0057968461           0.040325056
numero_consultas              1.0000000000          -0.059300863
semanas_gestacion_usg        -0.0593008633           1.000000000</code></pre>
</div>
</div>
<p>Esta es una matriz de correlación, la interpretación “estándar” (dependera del análisis y de las fuentes) es que una correlación perfecta tendría que tomar valores de 1 o -1, mientras que valores más cercanos a 0 implican que no existe una correlación. Además, un valor superior a 0.6 indica una fuerte correlación: si tiene signo negativo implica que el aumento de una variable necesariamente reduce la otra; mientras que un signo positivo, indica que el aumento de una variable significa el aumento de la otra.</p>
<p>Sin embargo, esta no es una manera inmediata de entender la relación entre variables.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'corrplot' was built under R version 4.2.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>corrplot 0.92 loaded</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(data_corr,</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">"upper"</span>, <span class="at">order =</span> <span class="st">"hclust"</span>,</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">tl.col =</span> <span class="st">"black"</span>, <span class="at">tl.srt =</span> <span class="dv">45</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Ahora bien, vamos por partes. Este paquete está diseñado para visualizar matrices de correlaciones, por lo cual es muy útil. Necesita, por lo menos, el parámetro <strong>corr</strong> que es la matriz de correlación. El resto de los parámetros son meramente estéticos: <strong>type = “upper”</strong> sirve para ver solo la parte superior, <strong>order</strong> indica como se van a ordenar las correlaciones (jerarquía) y <strong>tl.col</strong> y <strong>tl.srt</strong> sirven para determinar el color y la inclinación de las etiquetas. Los parametros de una función pueden consultarse si en la terminal o en el código escribe un signo de interrogación seguido del nombre de la función sin paréntesis: <strong>?corrplot</strong>. Esto funciona si el paquete está cargado (library).</p>
<p>Algo que podemos observar es que las correlaciones pueden ser interpretadas fácilmente: número de embarazos con número de parto; semanas de gestación y semanas de embarazo; edad y número de hijos. Todas con una relación positiva, lo que signfica, por ejemplo, que si aumenta la edad aumenta el número de hijos.</p>
<p>Sin embargo, con una correlación negativa está, aunque débil, edad de inicio de vida sexual y el número de embarazos. Lo que se puede interpretar como que personas que inician su vida sexual más tarde tienen un menor número de embarazos.</p>
<p>Para explorar estas relaciones se puede utilizar un diagrama de dispersión (<em>scatter plot</em>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(datos, <span class="fu">aes</span>(<span class="at">y =</span> edad_inicio_vida_sexual, <span class="at">x =</span> numero_embarazos)) <span class="sc">+</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">col =</span> nivel_edu, <span class="at">size =</span> numero_abortos)) <span class="sc">+</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 9136 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Con este código podemos visualizar la correlación entre el número de embarazos, eje x, y la edad, eje y, junto con otras dos variables: nivel educativo y número de abortos.</p>
<p>Y con estas herramientas ahora ustedes pueden realizar sus primeros análisis y empezar a jugar con otras bases de datos. Si bien el análisis puede continuar, este ejemplo pretende mostrar algunas operaciones básicas que se pueden hacer a una base de datos. Además, es necesario tener contexto de los datos, ya que sin un conocimiento previo de los datos limitan que tantos problemas podemos imaginar de un conjunto de datos.</p>
<p>Si creen que me falto algo, tienen dudas o quejas, no duden en contactarme para ampliar este post.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>